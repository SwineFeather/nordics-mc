import{r as d,j as s}from"./index-DUDTAd9W.js";const j=t=>{const a=t.normalize("NFD"),o={√•:"a",√§:"a",√∂:"o",√Ö:"A",√Ñ:"A",√ñ:"O",√©:"e",√®:"e",√™:"e",√´:"e",√°:"a",√†:"a",√¢:"a",√£:"a",√≠:"i",√¨:"i",√Æ:"i",√Ø:"i",√≥:"o",√≤:"o",√¥:"o",√µ:"o",√∫:"u",√π:"u",√ª:"u",√º:"u",√Ω:"y",√ø:"y",√±:"n",√ß:"c",√ü:"ss","ÃÄ":"","ÃÅ":"","ÃÇ":"","ÃÉ":"","ÃÑ":"","ÃÜ":"","Ãá":"","Ãà":"","Ãâ":"","Ãä":"","Ãã":"","Ãå":"","Ãß":"","Ã®":""};let e=a;for(const[r,i]of Object.entries(o))e=e.replace(new RegExp(r,"g"),i);return e=e.replace(/[^a-zA-Z0-9_\s]/g,"").replace(/\s+/g,"_").toLowerCase(),e||(e="unnamed"),e},v=(t,a)=>{if(a)return{name:t,url:a,width:300,height:200};const o="https://erdconvorgecupvavlwv.supabase.co/storage/v1/object/public/nation-town-images/towns/",e=j(t),r=`${o}${e}.png`;return{name:t,url:r,width:300,height:200}},w=(t,a)=>{const o=t.target,{naturalWidth:e,naturalHeight:r}=o,i=e/r;let c=300,n=200;i>1.5?(c=400,n=Math.round(400/i)):i<.75?(n=300,c=Math.round(300*i)):(c=300,n=Math.round(300/i)),a({width:c,height:n})},E=({townName:t,className:a="",fallbackSrc:o="/placeholder.svg",style:e={},imageUrl:r})=>{const[i,c]=d.useState({width:300,height:200}),[n,h]=d.useState(!1),[u,m]=d.useState(!1),g=v(t,r),x=f=>{m(!0),w(f,c)},p=()=>{h(!0)},l=a.includes("h-")||a.includes("w-")||e.width&&e.width!=="auto"||e.height&&e.height!=="auto"?{...e,maxWidth:"80%",maxHeight:"80%",width:"auto",height:"auto"}:{...e,maxWidth:"32px",maxHeight:"32px",width:"auto",height:"auto"};return n?s.jsx("div",{className:`bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center ${a}`,style:l,children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl mb-1",children:"üèòÔ∏è"}),s.jsx("div",{className:"text-xs text-gray-600 font-medium truncate",children:t})]})}):s.jsxs("div",{className:`relative ${a}`,children:[s.jsx("img",{src:g.url,alt:`${t} town profile`,className:"transition-opacity duration-300",style:l,onLoad:x,onError:p}),!u&&!n&&s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center animate-pulse",style:l,children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xl mb-1",children:"‚è≥"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Loading..."})]})})]})};export{E as T};
