import{r as s,s as f}from"./index-BDwxLbfg.js";const S=()=>{const[u,h]=s.useState([]),[p,o]=s.useState(!0),[w,a]=s.useState(null),[d,i]=s.useState(null),c=s.useCallback(async()=>{try{o(!0),a(null);const{data:r,error:e}=await f.from("shops").select("*").order("last_updated",{ascending:!1});if(e)throw e;const t=(r==null?void 0:r.map(n=>({...n,owner_name:n.owner_uuid,owner_avatar:void 0})))||[];h(t),i(new Date)}catch(r){console.error("Error fetching shops:",r),a(r instanceof Error?r.message:"Failed to fetch shops")}finally{o(!1)}},[]),y=s.useCallback(async r=>{try{o(!0),a(null);const{data:e,error:t}=await f.from("shops").select("*").eq("type",r).order("last_updated",{ascending:!1});if(t)throw t;const n=(e==null?void 0:e.map(l=>({...l,owner_name:l.owner_uuid,owner_avatar:void 0})))||[];h(n),i(new Date)}catch(e){console.error("Error fetching shops by type:",e),a(e instanceof Error?e.message:"Failed to fetch shops")}finally{o(!1)}},[]),m=s.useCallback(async r=>{try{o(!0),a(null);const{data:e,error:t}=await f.from("shops").select("*").ilike("item_type",`%${r}%`).order("last_updated",{ascending:!1});if(t)throw t;const n=(e==null?void 0:e.map(l=>({...l,owner_name:l.owner_uuid,owner_avatar:void 0})))||[];h(n),i(new Date)}catch(e){console.error("Error fetching shops by item:",e),a(e instanceof Error?e.message:"Failed to fetch shops")}finally{o(!1)}},[]),_=s.useCallback(()=>{c()},[c]);return s.useEffect(()=>{c()},[c]),{shops:u,loading:p,error:w,lastSync:d,fetchShops:c,fetchShopsByType:y,fetchShopsByItem:m,refreshShops:_}};export{S as u};
