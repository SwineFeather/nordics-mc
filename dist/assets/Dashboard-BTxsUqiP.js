import{I as D,r as i,j as e,w as p,x as g,y,z as N,B as U,v as a,b2 as O,u as Y,ay as B,cb as V,bd as _,cc as P,be as A,b5 as $,a5 as E,az as q,b7 as H,af as J,cd as K}from"./index-BDwxLbfg.js";import{u as Q}from"./use-toast-IlxM9Ntm.js";import{C as W}from"./copy-D3RDa5qZ.js";import{E as G}from"./external-link-DMGOVlse.js";import{T as X}from"./trophy-Cs7EAtCN.js";import{M as Z}from"./mail-DdsCDVWN.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=D("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),se=({playerName:s,className:x})=>{const[u,h]=i.useState(!1),{toast:j}=Q(),n=`${window.location.origin}/community?player=${encodeURIComponent(s)}`,b=async()=>{try{await navigator.clipboard.writeText(n),h(!0),j({title:"Profile URL copied!",description:"You can now share your profile link with others."}),setTimeout(()=>h(!1),2e3)}catch(w){console.error("Failed to copy to clipboard:",w),j({title:"Failed to copy",description:"Please copy the URL manually.",variant:"destructive"})}},k=()=>{window.open(n,"_blank")};return e.jsxs(p,{className:x,children:[e.jsx(g,{children:e.jsx(y,{className:"flex items-center text-lg",children:"Share Your Profile"})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Your Profile URL"}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded-md",children:[e.jsx("code",{className:"text-xs flex-1 truncate",children:n}),e.jsx(U,{variant:"secondary",className:"text-xs",children:"Public"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{onClick:b,size:"sm",className:"flex-1",disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Copy Link"]})}),e.jsxs(a,{onClick:k,variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"View Profile"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Anyone with this link can view your public profile and stats."})]})]})},oe=()=>{const[s,x]=i.useState(null),[u,h]=i.useState(!0),[j,n]=i.useState(!1),[b,k]=i.useState("profile"),[w,v]=i.useState(!1),c=Y(),{signOut:z,isAuthenticated:S,user:ae,profile:o,isTokenLinkUser:r}=B();i.useEffect(()=>{var T,I;const l=localStorage.getItem("tokenlink_profile_id"),f=localStorage.getItem("player_uuid"),m=localStorage.getItem("player_name"),C=localStorage.getItem("profile");if(console.log("Dashboard loading with TokenLink data:",{hasProfileId:!!l,hasUuid:!!f,hasName:!!m,hasProfile:!!C,isAuthenticated:S,hasAuthProfile:!!o}),!S&&(!f||!m)){console.log("No authentication found, redirecting to login"),c("/");return}if(o){console.log("Using auth profile:",o),x(o);const t=(T=o.email)==null?void 0:T.includes("@tokenlink.local");v(t)}else if(C)try{const t=JSON.parse(C);console.log("Loaded TokenLink profile:",t),x(t);const R=(I=t.email)==null?void 0:I.includes("@tokenlink.local");v(R)}catch(t){console.error("Error parsing profile data:",t)}else if(f&&m){const t={id:l||f,email:m+"@tokenlink.local",full_name:m,role:"member",minecraft_username:m};x(t),v(!0)}h(!1)},[c,S,o]);const M=async()=>{console.log("Logging out user"),localStorage.removeItem("tokenlink_profile_id"),localStorage.removeItem("player_uuid"),localStorage.removeItem("player_name"),localStorage.removeItem("profile");try{await z()}catch(l){console.error("Sign out error:",l)}c("/")},F=()=>{const l=(s==null?void 0:s.minecraft_username)||localStorage.getItem("player_name");l&&c(`/community?player=${encodeURIComponent(l)}`)},d=(l="profile")=>{k(l),n(!0)};if(u)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})});const L=(s==null?void 0:s.minecraft_username)||localStorage.getItem("player_name")||"Unknown Player";return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx("h1",{className:"text-xl font-bold",children:"Dashboard"})}),e.jsxs(a,{onClick:M,variant:"outline",size:"sm",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Logout"]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Welcome back, ",L,"!"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account and explore the community"})]}),r&&e.jsxs(_,{className:"mb-6 border-blue-200 bg-blue-50",children:[e.jsx(P,{className:"h-4 w-4 text-blue-600"}),e.jsx(A,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-800",children:"Upgrade Your Account"}),e.jsx("p",{className:"text-blue-700",children:"Add email and password authentication for enhanced security and full website access."})]}),e.jsxs(a,{variant:"outline",size:"sm",onClick:()=>d("upgrade"),className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Upgrade Now"]})]})})]}),w&&!r&&e.jsxs(_,{className:"mb-6",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx(A,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Complete your account setup by adding an email and password for enhanced security."}),e.jsx(a,{variant:"outline",size:"sm",onClick:()=>d("security"),children:"Setup Now"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(p,{children:[e.jsx(g,{children:e.jsxs(y,{className:"flex items-center",children:[e.jsx(E,{className:"w-5 h-5 mr-2"}),"Profile Information"]})}),e.jsx(N,{className:"space-y-4",children:s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Minecraft Username"}),e.jsx("p",{className:"text-lg font-semibold mt-1",children:s.minecraft_username||s.full_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{className:"text-sm mt-1 font-mono",children:s.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Role"}),e.jsx("div",{className:"mt-1",children:e.jsx(U,{variant:"secondary",className:"capitalize",children:s.role})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Account Type"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(q,{className:"w-4 h-4 text-green-600 mr-1"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:r?"TokenLink":"Standard"}),r&&e.jsx(U,{variant:"outline",className:"ml-2 text-xs",children:"Can be upgraded"})]})]})]})})]}),e.jsx(se,{playerName:L})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(p,{children:[e.jsx(g,{children:e.jsx(y,{children:"Quick Actions"})}),e.jsxs(N,{className:"space-y-3",children:[e.jsxs(a,{className:"w-full justify-start",onClick:F,children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"View My Profile"]}),e.jsxs(a,{variant:"outline",className:"w-full justify-start",onClick:()=>c("/community"),children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Community"]}),e.jsxs(a,{variant:"outline",className:"w-full justify-start",onClick:()=>c("/forum"),children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Forum"]}),e.jsxs(a,{variant:"outline",className:"w-full justify-start",onClick:()=>d("profile"),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Edit Profile"]}),e.jsxs(a,{variant:"outline",className:"w-full justify-start",onClick:()=>d("notifications"),children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Preferences"]}),r&&e.jsxs(a,{variant:"default",className:"w-full justify-start bg-blue-600 hover:bg-blue-700",onClick:()=>d("upgrade"),children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Upgrade Account"]})]})]}),e.jsxs(p,{children:[e.jsx(g,{children:e.jsx(y,{children:"Account Security"})}),e.jsxs(N,{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"mb-2",children:r?"Strengthen your TokenLink account:":"Manage your account security:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:r?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"• Add a secure email address"}),e.jsx("li",{children:"• Set a strong password"}),e.jsx("li",{children:"• Enable full website features"})]}):e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"• Change your password"}),e.jsx("li",{children:"• Update your email address"}),e.jsx("li",{children:"• Manage account security"})]})})]}),e.jsxs(a,{variant:"outline",size:"sm",className:"w-full",onClick:()=>d("security"),children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Security Settings"]})]})]})]})]})]}),e.jsx(K,{open:j,onClose:()=>n(!1),defaultTab:b})]})};export{oe as default};
