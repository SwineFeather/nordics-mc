import{r as u,s as o}from"./index-BDwxLbfg.js";import{u as f}from"./use-toast-IlxM9Ntm.js";const _=()=>{const[l,t]=u.useState(!1),{toast:c}=f();return{loading:l,checkUsernameAvailability:async s=>{try{t(!0),console.log("🔍 Checking username availability for:",s);const{data:r,error:e}=await o.rpc("check_username_conflict",{p_username:s});if(console.log("📡 Supabase RPC response:",{data:r,error:e}),e)throw console.error("❌ Supabase RPC error:",e),e;if(Array.isArray(r)&&r.length>0){const i=r[0],n={available:!i.has_conflict,message:i.message,conflictType:i.conflict_type};return console.log("✅ Username check result (from array):",n),n}const a={available:!r.has_conflict,message:r.message,conflictType:r.conflict_type};return console.log("✅ Username check result (single):",a),a}catch(r){return console.error("💥 Error checking username:",r),c({title:"Error",description:"Failed to check username availability",variant:"destructive"}),{available:!1,message:"Error checking username",conflictType:"error"}}finally{t(!1)}},createWebsiteAccount:async(s,r)=>{try{t(!0);const{data:e,error:a}=await o.rpc("create_website_account",{p_email:s,p_username:r,p_full_name:r});if(a)throw a;if(!e.success)throw new Error(e.message);return c({title:"Success",description:"Account created successfully!"}),e}catch(e){throw console.error("Error creating account:",e),c({title:"Error",description:e instanceof Error?e.message:"Failed to create account",variant:"destructive"}),e}finally{t(!1)}},setMinecraftUserEmail:async(s,r)=>{try{t(!0);const{data:e,error:a}=await o.rpc("set_minecraft_user_email",{p_profile_id:s,p_email:r});if(a)throw a;if(!e.success)throw new Error(e.message);return c({title:"Success",description:"Email set successfully!"}),e}catch(e){throw console.error("Error setting email:",e),c({title:"Error",description:e instanceof Error?e.message:"Failed to set email",variant:"destructive"}),e}finally{t(!1)}},changeMinecraftDisplayName:async(s,r)=>{try{t(!0);const{data:e,error:a}=await o.rpc("change_minecraft_display_name",{p_profile_id:s,p_new_display_name:r});if(a)throw a;if(!e.success)throw new Error(e.message);return c({title:"Success",description:"Display name updated successfully!"}),e}catch(e){throw console.error("Error changing display name:",e),c({title:"Error",description:e instanceof Error?e.message:"Failed to update display name",variant:"destructive"}),e}finally{t(!1)}}}};export{_ as u};
