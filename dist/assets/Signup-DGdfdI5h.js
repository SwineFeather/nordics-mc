import{r as t,u as P,j as e,w as S,x as T,y as A,bU as E,z as I,O as n,X as c,v as q,aI as F}from"./index-BDwxLbfg.js";import{u as L}from"./useAccountManagement-BNEM0IL-.js";import{u as M}from"./use-toast-IlxM9Ntm.js";import{L as _}from"./loader-circle-BQXbm3ye.js";import{C as B}from"./circle-x-hzf92Dg-.js";const D=()=>{const[u,g]=t.useState(""),[r,v]=t.useState(""),[i,j]=t.useState(""),[o,y]=t.useState(""),[s,d]=t.useState(null),[b,x]=t.useState(!1),h=P(),{createWebsiteAccount:N,checkUsernameAvailability:p,loading:f}=L(),{toast:m}=M();t.useEffect(()=>{if(r.length<3){d(null);return}const a=setTimeout(async()=>{console.log("ðŸ”„ Starting username check for:",r),x(!0);try{const l=await p(r);console.log("ðŸ“‹ Username check completed:",l),d(l)}catch(l){console.error("ðŸ’¥ Username check failed:",l),d({available:!1,message:"Error checking username",conflictType:"error"})}finally{x(!1)}},500);return()=>clearTimeout(a)},[r,p]);const w=async a=>{if(a.preventDefault(),i!==o){m({title:"Error",description:"Passwords do not match",variant:"destructive"});return}if(!(s!=null&&s.available)){m({title:"Invalid Username",description:"Please choose a different username",variant:"destructive"});return}try{await N(u,r),m({title:"Success",description:"Account created successfully! Please check your email to verify your account."}),h("/login")}catch{}},C=()=>b?e.jsx(_,{className:"h-4 w-4 animate-spin text-blue-500"}):s!=null&&s.available?e.jsx(F,{className:"h-4 w-4 text-green-500"}):s&&!s.available?e.jsx(B,{className:"h-4 w-4 text-red-500"}):null,U=()=>s!=null&&s.available?"text-green-600":s&&!s.available?"text-red-600":"text-gray-500",k=()=>s?s.conflictType==="minecraft_reserved"||s.conflictType==="minecraft_player_exists"?e.jsxs("div",{className:"text-sm text-red-600",children:[e.jsx("div",{className:"font-medium",children:s.message}),e.jsxs("div",{className:"mt-1 p-2 bg-red-50 border border-red-200 rounded text-xs",children:[e.jsx("p",{className:"font-medium text-red-800 mb-1",children:"To claim this username:"}),e.jsxs("ol",{className:"text-red-700 space-y-1",children:[e.jsx("li",{children:"1. Join the Minecraft server"}),e.jsxs("li",{children:["2. Type ",e.jsx("code",{className:"bg-red-100 px-1 rounded",children:"/login"})," in chat"]}),e.jsx("li",{children:"3. Click the link provided to claim your account"})]})]})]}):e.jsx("div",{className:`text-sm ${U()}`,children:s.message}):null;return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs(S,{className:"w-full max-w-md",children:[e.jsxs(T,{className:"space-y-1",children:[e.jsx(A,{className:"text-2xl font-bold text-center",children:"Create Account"}),e.jsx(E,{className:"text-center",children:"Join the Nordics community"}),e.jsx("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-800 text-center",children:[e.jsx("strong",{children:"Note:"})," Minecraft usernames are reserved for players. If your username is taken, use ",e.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"/login"})," in-game to claim it."]})})]}),e.jsx(I,{children:e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"email",children:"Email"}),e.jsx(c,{type:"email",id:"email",value:u,onChange:a=>g(a.target.value),required:!0,placeholder:"Enter your email address",className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"username",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{type:"text",id:"username",value:r,onChange:a=>v(a.target.value),required:!0,minLength:3,placeholder:"Choose a unique username",className:"w-full pr-10"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:C()})]}),k(),r.length>0&&r.length<3&&e.jsx("div",{className:"text-sm text-yellow-600",children:"Username must be at least 3 characters long"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"password",children:"Password"}),e.jsx(c,{type:"password",id:"password",value:i,onChange:a=>j(a.target.value),required:!0,minLength:8,placeholder:"Create a strong password (min 8 characters)",className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(c,{type:"password",id:"confirmPassword",value:o,onChange:a=>y(a.target.value),required:!0,placeholder:"Confirm your password",className:"w-full"})]}),e.jsx(q,{type:"submit",disabled:f||!(s!=null&&s.available)||i!==o,className:"w-full",children:f?"Creating Account...":"Create Account"}),e.jsxs("div",{className:"text-center text-sm text-gray-600",children:["Already have an account?"," ",e.jsx("button",{type:"button",onClick:()=>h("/login"),className:"text-blue-600 hover:text-blue-500 font-medium",children:"Sign in"})]})]})})]})})},R=()=>e.jsx(D,{});export{R as default};
