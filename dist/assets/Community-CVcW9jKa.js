import{I as Y,r as g,S as ue,T as he,V as be,j as e,w as A,z as R,W as q,X as xe,v as S,Y as ge,Z as fe,$ as pe,a0 as ye,a1 as je,a2 as C,B as w,a3 as W,l as ve,m as Ne,n as we,a4 as Z,H as Q,a5 as Se,a6 as ke,a7 as Pe,G as X,a8 as Ce,Q as Le,a9 as _e,aa as Ae,ab as Re,ac as Fe,ad as Me,ae as Be,af as Ie,ag as Ee,ah as Te,ai as Oe,aj as ze,ak as $e,al as Ge,am as He,an as Ue,ao as J,ap as ee,u as ae,aq as Ve,ar as De,as as Ke,at as Ye,au as qe,av as O,U as We,aw as z}from"./index-BDwxLbfg.js";import{T as Ze,N as Qe}from"./TownsTab-BqXrfFKi.js";import{u as Xe}from"./usePlayerSearch-6-rZ-bFC.js";import{F as Je}from"./filter-NS2wN-5_.js";import{B as ea}from"./building-nraDPmQ5.js";import{L as aa}from"./loader-circle-BQXbm3ye.js";import{C as sa}from"./chevron-left-DazXsnHj.js";import"./skeleton-Cl9ccUyr.js";import"./imageStorageService-Bbnc4G-y.js";import"./image-CdpHxvLf.js";import"./upload-B5TiAeXb.js";import"./link-BSO0-lYh.js";import"./copy-D3RDa5qZ.js";import"./external-link-DMGOVlse.js";import"./use-toast-IlxM9Ntm.js";import"./square-pen-BbMsOEvb.js";import"./save-CBFCkKxY.js";import"./banknote-CpRk0iOT.js";import"./TownProfileModal-wTTCjwjS.js";import"./TownPhotoGallery-B9IvuerC.js";import"./pen-line-DhrBiHG4.js";import"./download-Den2hQ9Q.js";import"./list-DgrYmvyF.js";import"./TownProfilePicture-CY--EK_H.js";import"./coins-C6lwFDE4.js";import"./user-plus-v6PF39qN.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=Y("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=Y("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]),na=({limit:a,offset:m=0,skipDetailedStats:n=!1})=>{const u=g.useRef(0),t=g.useRef(!1),b=60*60*1e3;g.useEffect(()=>{const s=()=>{t.current=!document.hidden};return t.current=!document.hidden,document.addEventListener("visibilitychange",s),()=>{document.removeEventListener("visibilitychange",s)}},[]);const{data:i,isLoading:y,isFetching:d,error:j,refetch:r}=ue({queryKey:["playerProfilesConditional",a,m,n],queryFn:()=>(u.current=Date.now(),he({limit:a,offset:m,skipDetailedStats:n})),placeholderData:be,retry:2,retryDelay:1e3,staleTime:b,refetchInterval:s=>Date.now()-u.current>=b&&t.current?(console.log("Conditional refetch: Page visible and 1 hour passed"),0):!1}),l=(i==null?void 0:i.players)??[],o=(i==null?void 0:i.count)??0,h=o>0&&m+l.length<o;return{profiles:l,loading:y,total:o,hasMore:h,loadingMore:d&&!y,error:j,refetch:r}},la=({searchTerm:a,onSearchChange:m,sortBy:n,onSortChange:u,filterOnline:t,onFilterOnlineChange:b,totalResults:i})=>{const[y,d]=g.useState(!1),j=()=>{m("")};return e.jsx(A,{className:"mb-6",children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(xe,{placeholder:"Search players by name...",value:a,onChange:r=>m(r.target.value),className:"pl-10 pr-20"}),e.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-2",children:[a&&e.jsx(S,{variant:"ghost",size:"sm",onClick:j,className:"h-6 w-6 p-0",children:e.jsx(ge,{className:"w-3 h-3"})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>d(!y),className:"flex items-center gap-1",children:[e.jsx(Je,{className:"w-3 h-3"}),"Filters"]})]})]}),y&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Sort By"}),e.jsxs(fe,{value:n,onValueChange:u,children:[e.jsx(pe,{children:e.jsx(ye,{})}),e.jsxs(je,{children:[e.jsx(C,{value:"priority",children:"Priority (Influence + Badges)"}),e.jsx(C,{value:"name",children:"Name (A-Z)"}),e.jsx(C,{value:"level",children:"Level"}),e.jsx(C,{value:"playtime",children:"Playtime"}),e.jsx(C,{value:"medals",children:"Medal Points"}),e.jsx(C,{value:"activity",children:"Influence Score"}),e.jsx(C,{value:"balance",children:"Balance"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(S,{variant:t?"default":"outline",onClick:()=>b(!t),className:"w-full",children:t?"Showing Online Only":"Show Online Only"})}),e.jsx("div",{className:"flex items-end",children:e.jsx(S,{variant:"outline",onClick:()=>{m(""),u("priority"),b(!1)},className:"w-full",children:"Clear All Filters"})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:[i," player",i!==1?"s":""," found",a&&a.trim().length>=2&&e.jsx("span",{className:"ml-2 text-xs",children:"(Searching all players, not just top 48)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsxs(w,{variant:"secondary",children:['Search: "',a,'"']}),t&&e.jsx(w,{variant:"secondary",children:"Online Only"})]})]})]})})})},$={User:e.jsx(Se,{className:"w-3 h-3"}),Star:e.jsx(Z,{className:"w-3 h-3"}),Award:e.jsx(ke,{className:"w-3 h-3"}),Sparkles:e.jsx(Pe,{className:"w-3 h-3"}),Crown:e.jsx(X,{className:"w-3 h-3"}),Heart:e.jsx(Ce,{className:"w-3 h-3"}),Globe:e.jsx(Le,{className:"w-3 h-3"}),Book:e.jsx(_e,{className:"w-3 h-3"}),Wrench:e.jsx(Ae,{className:"w-3 h-3"}),Flame:e.jsx(Re,{className:"w-3 h-3"}),Sun:e.jsx(Fe,{className:"w-3 h-3"}),Moon:e.jsx(Me,{className:"w-3 h-3"}),Zap:e.jsx(Be,{className:"w-3 h-3"}),Key:e.jsx(Ie,{className:"w-3 h-3"}),Lock:e.jsx(Ee,{className:"w-3 h-3"}),Smile:e.jsx(Te,{className:"w-3 h-3"}),Ghost:e.jsx(Oe,{className:"w-3 h-3"}),Skull:e.jsx(ze,{className:"w-3 h-3"}),Leaf:e.jsx($e,{className:"w-3 h-3"}),Rocket:e.jsx(Ge,{className:"w-3 h-3"}),Sword:e.jsx(He,{className:"w-3 h-3"}),Wand2:e.jsx(Ue,{className:"w-3 h-3"})},se=({profile:a,onClick:m,allResidents:n=[],showDetailedStats:u=!0,isSearchResult:t=!1})=>{var l,o,h;const{onlinePlayers:b}=W(),i=b.some(s=>!s.name||typeof s.name!="string"?(console.log("Invalid player data:",s),!1):s.name.toLowerCase()===a.username.toLowerCase()),y=s=>{switch(s.toLowerCase()){case"admin":return"bg-red-500";case"moderator":return"bg-orange-500";case"vip":return"bg-purple-500";case"kala":return"bg-green-500";case"fancy kala":return"bg-blue-500";case"golden kala":return"bg-yellow-500";case"former supporter":return"bg-purple-500";default:return"bg-gray-500"}},d=n==null?void 0:n.find(s=>s.name===a.username);d!=null&&d.activity_score;const j=((l=a.badges)==null?void 0:l.find(s=>s.is_verified))||((o=a.badges)==null?void 0:o[0]),r=s=>{s.stopPropagation(),m()};return e.jsx(A,{className:"hover:shadow-lg transition-shadow cursor-pointer dark:bg-card dark:border-border",onClick:m,children:e.jsx(R,{className:"p-3",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(ve,{className:"h-10 w-10",children:[e.jsx(Ne,{src:`https://mc-heads.net/avatar/${a.username}/64`}),e.jsx(we,{className:"text-xs",children:(h=a.username)==null?void 0:h.slice(0,2).toUpperCase()})]}),i&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white dark:border-gray-800 animate-pulse"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-sm truncate dark:text-white hover:text-primary cursor-pointer transition-colors",onClick:r,title:"Click to view full profile",children:a.displayName||a.username}),a.badges&&a.badges.length>0&&e.jsx(e.Fragment,{children:a.badges.filter(s=>["Admin","Moderator","Helper"].includes(s.badge_type)).map(s=>e.jsxs(w,{style:{backgroundColor:s.badge_color,color:"white"},className:"text-xs flex items-center gap-1",children:[$[s.icon]||$.User,!s.icon_only&&e.jsx("span",{children:s.badge_type})]},s.id))}),a.serverRole&&a.serverRole!=="Member"&&(!j||j.badge_type.toLowerCase()!==a.serverRole.toLowerCase())&&e.jsx(w,{variant:"outline",className:`text-xs ${y(a.serverRole)} text-white`,children:a.serverRole}),u&&!j&&a.badges===void 0&&e.jsx("div",{className:"w-4 h-4 animate-spin rounded-full border-2 border-gray-300 border-t-primary"})]}),a.badges&&a.badges.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-1",children:[a.badges.filter(s=>!["Admin","Moderator","Helper"].includes(s.badge_type)).slice(0,3).map(s=>{const x=$[s.icon]||e.jsx(Z,{className:"w-3 h-3"});return e.jsx(w,{variant:"outline",className:"text-xs px-1.5 py-0.5",style:{borderColor:s.badge_color,color:s.badge_color},children:x},s.id)}),a.badges.filter(s=>!["Admin","Moderator","Helper"].includes(s.badge_type)).length>3&&e.jsxs(w,{variant:"outline",className:"text-xs px-1.5 py-0.5",children:["+",a.badges.filter(s=>!["Admin","Moderator","Helper"].includes(s.badge_type)).length-3]})]}),((d==null?void 0:d.nation_name)||(d==null?void 0:d.town_name))&&e.jsxs("div",{className:"flex items-center gap-2 mb-1 text-xs text-muted-foreground",children:[d.nation_name&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"w-3 h-3"}),e.jsx("span",{children:d.nation_name})]}),d.town_name&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ea,{className:"w-3 h-3"}),e.jsx("span",{children:d.town_name})]})]})]})]})})})},ca=({players:a,loading:m,searchTerm:n,onPlayerClick:u})=>{const{data:t}=J();return m?e.jsx(A,{className:"dark:bg-card dark:border-border",children:e.jsx(R,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(aa,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Searching for players..."})]})})}):a.length===0&&n.trim().length>=2?e.jsx(A,{className:"dark:bg-card dark:border-border",children:e.jsxs(R,{className:"p-6 text-center",children:[e.jsx(q,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground"}),e.jsxs("p",{className:"text-muted-foreground",children:['No players found matching "',n,'"']}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Try a different search term or check the spelling"})]})}):n.trim().length<2?null:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(w,{variant:"outline",className:"text-sm",children:["Found ",a.length," player",a.length!==1?"s":"",' for "',n,'"']})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(b=>e.jsx(se,{profile:b,onClick:()=>u(b),allResidents:t||[],showDetailedStats:!0,isSearchResult:!0},b.id))})]})},I={Admin:100,Moderator:90,Helper:80,"Golden Kala":70,"Fancy Kala":60,Kala:50,VIP:40,"Former Supporter":30,Member:20,Player:10},ia={admin:100,moderator:90,helper:80,"golden kala":70,"fancy kala":60,kala:50,vip:40,"former supporter":30,member:20,player:10},K=["9af29b79-1017-455c-9e9b-073be806070f","75c88432-a4ed-4f01-a660-b98783a0ed1b","da616567-2b70-4be5-bab6-e2e3852559eb","27bb781d-5f62-4543-a069-77adc116ee5f","4dc2109d-95c3-4822-914e-ed164bfc3171","2b3273dd-e2f5-4304-ba9d-7a7508a4a39c","1e0f36ad-256c-45cd-af46-c8c113af9883","e2c9a0a5-72e9-419b-bb9e-9accdd6d738e","e222eb39-2c6e-4971-b2e6-e50e11967dbd","4440bf97-ac79-490c-9136-b0ca86c44c94","7f4e5948-d1fc-4c55-b6e4-da8dd5e009ef","0a462d6e-3de9-4a0c-a509-83caccd9f200","5fa6e75f-ff5f-45fb-9caa-65ba1becb52c","83170932-9d0d-4222-98fa-b9e744bc5d9c","8e194000-71dd-4fbc-b27b-41ba2e8d5086","f556595c-08b7-492c-bdb8-4ca50dc26eb0","46a8c57d-2861-48ce-b29b-bbe001e9a4ef","cc96d930-265a-41b4-bc1b-2369d2090f55","b4aa321d-efd3-4c7d-aca1-417923c8f9bb","85c4a3d7-5584-4851-963d-807147e15b5c","dd3c5057-82fa-4095-a90c-a9149f33bd15","9a8a5c1a-1cf9-4ebd-8ca6-2440f67e4fe6","02513333-75e9-4362-9284-a4f71b0e50c3","f70bd359-f888-43b3-b584-b726763f8fc8","6ef45aa4-ca4e-4362-bf8f-a6455d42e9ee","294ae756-bad7-4edc-a614-730c97c07c71","e9a27ebe-550f-4501-bd6b-0b36822433b4","ab2d3c24-beee-4c41-b0ed-405bb8953973","5c88c5e1-d7f4-49ec-b7a9-d59e493d52b2","7fa1db47-5a3a-42c3-80a0-b23aa0c1fda2","8c926aef-5e13-4be9-8244-2a2d796f55f6","5a3af22c-1648-460a-a993-c9a8c9c1fc52","66fa37fd-9f3f-4358-9bd3-9872c3f4830c","02ff780f-8abf-4142-b81b-c16ef64fdc07","db0ab135-509a-4934-b7e0-ceec8d4d6681","5dc2402f-ab23-47db-aeff-6aadc04eaf5d","e6c186f1-6e94-4fe4-9290-96555bfa3184","99899779-dcb6-4710-b7d8-c82eba3fab02","ee3c2d83-4af6-4c1d-add5-2df516cdbf35","528765eb-ced6-41ff-9629-e95a13cca07c","5ddc97ff-d36a-4267-9581-ff70da50d876","e1107273-826b-4f78-badd-3d817eea4545","e147e8a3-0e87-4288-96fb-e17cd57dc4b2","c358151d-ef68-4fcc-8ebd-6f2d435813ed","627111f0-e57f-4582-aad0-a36300fdfdf7","222ed90e-6a68-4198-bae9-1c73ee325853","4e45e8e1-7a54-4a86-8f49-31cb797ed03d","368c837b-f69c-4cef-8576-c2f0321cef9d","18e63085-1196-4be7-b91f-3984dc6bad81"],da=({profiles:a,onPlayerClick:m,allResidents:n,searchTerm:u,statusFilter:t,showDetailedStats:b,onlinePlayers:i,sortBy:y})=>{const d=(r,l)=>{let o=0;if(r.id==="9af29b79-1017-455c-9e9b-073be806070f")return 2e6;if(r.badges&&r.badges.length>0){const s=r.badges.find(x=>["Admin","Moderator","Helper"].includes(x.badge_type));if(s){const x=I[s.badge_type]||0;return o+=x*1e5,console.log(`Staff member ${r.username} (${s.badge_type}): calculated priority = ${o}`),o}}if(r.badges&&r.badges.length>0){const s=r.badges.reduce((p,f)=>{const k=I[f.badge_type]||0,L=I[p.badge_type]||0;return k>L?f:p}),x=I[s.badge_type]||0;o+=x*1e4}if(r.serverRole){const s=ia[r.serverRole.toLowerCase()]||0;o+=s*1e3}if(r.id&&K.includes(r.id)){const s=K.indexOf(r.id);o+=(100-s)*100}const h=(l==null?void 0:l.activity_score)||0;return h>=200&&(o+=h),o},j=g.useMemo(()=>!a||!Array.isArray(a)?(console.warn("PlayerGrid: Profiles is not an array:",a),[]):!i||!Array.isArray(i)?(console.warn("PlayerGrid: onlinePlayers is not an array:",i),a):(console.log("PlayerGrid: Sorting by:",y,"with",a.length,"profiles"),a.filter(r=>{var l,o;if(!r)return!1;if(u){const h=u.toLowerCase(),s=(l=r.username)==null?void 0:l.toLowerCase().includes(h),x=(o=r.displayName)==null?void 0:o.toLowerCase().includes(h);if(!s&&!x)return!1}if(t!=="all"){const h=i.some(s=>{var x;return s.name&&typeof s.name=="string"&&s.name.toLowerCase()===((x=r.username)==null?void 0:x.toLowerCase())});if(t==="online"&&!h||t==="offline"&&h)return!1}return!0}).map(r=>{const l=n==null?void 0:n.find(h=>h.name===r.username),o=d(r,l);return r.badges&&r.badges.some(h=>["Admin","Moderator","Helper"].includes(h.badge_type))&&console.log(`Staff member ${r.username}: priority=${o}, badges=`,r.badges.map(h=>h.badge_type)),{...r,priority:o,residentData:l}}).sort((r,l)=>{var o,h;switch(y){case"name":return(r.username||r.displayName||"").localeCompare(l.username||l.displayName||"");case"level":const s=r.level||0,x=l.level||0;if(x!==s)return x-s;break;case"playtime":const p=r.playtime||0,f=l.playtime||0;if(f!==p)return f-p;break;case"medals":const k=r.medals||0,L=l.medals||0;if(L!==k)return L-k;break;case"activity":const E=((o=r.residentData)==null?void 0:o.activity_score)||0,P=((h=l.residentData)==null?void 0:h.activity_score)||0;if(P!==E)return P-E;break;case"balance":const B=r.balance||0,_=l.balance||0;if(_!==B)return _-B;break;case"priority":default:if(l.priority!==r.priority)return l.priority-r.priority;break}return(r.username||r.displayName||"").localeCompare(l.username||l.displayName||"")})),[a,u,t,n,i,y]);return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(r=>e.jsx(oa,{profile:r,onClick:()=>m(r),allResidents:n,showDetailedStats:b},r.id))})},oa=({profile:a,onClick:m,allResidents:n,showDetailedStats:u})=>e.jsx(se,{profile:a,onClick:m,allResidents:n,showDetailedStats:u,isSearchResult:!1}),ma=()=>{const[a,m]=ee();ae();const[n,u]=g.useState(null),[t,b]=g.useState(a.get("search")||""),[i,y]=g.useState(a.get("sort")||"priority"),[d,j]=g.useState("all"),[r,l]=g.useState(0),[o,h]=g.useState(!0),[s,x]=g.useState(50);g.useEffect(()=>{console.log("PlayerDirectory: Initial sortBy set to:",i)},[i]),g.useEffect(()=>{const c=new URLSearchParams(a);i==="priority"?c.delete("sort"):c.set("sort",i),m(c)},[i,a,m]),g.useEffect(()=>{l(0)},[s]);const{profiles:p,loading:f,error:k,hasMore:L,loadingMore:E,total:P}=na({limit:s,offset:r*s,skipDetailedStats:!o}),{players:B,loading:_,count:G}=Xe(t),{data:re,loading:te}=J(),{onlinePlayers:H=[],loading:ne}=W(),le=Array.isArray(H)?H:[],v=Math.ceil((P||0)/s),T=r+1;g.useEffect(()=>{const c=a.get("search");c&&c!==t&&b(c)},[a,t]),g.useEffect(()=>{const c=a.get("player");if(c&&p.length>0&&!n){const N=p.find(M=>{var V,D;return((V=M.username)==null?void 0:V.toLowerCase())===c.toLowerCase()||((D=M.displayName)==null?void 0:D.toLowerCase())===c.toLowerCase()});N&&u(N)}},[a,p,n]);const U=c=>{const N=c.username||c.displayName;if(N){const M=new URLSearchParams(a);M.set("player",N),m(M),u(c)}},ce=()=>{u(null);const c=new URLSearchParams(a);c.delete("player"),m(c)},F=c=>{c>=0&&c<v&&(l(c),window.scrollTo({top:0,behavior:"smooth"}))},ie=()=>F(0),de=()=>F(v-1),oe=()=>F(r-1),me=()=>F(r+1);return f||te||ne?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-20 bg-muted/50 rounded-lg animate-pulse"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(9)].map((c,N)=>e.jsx("div",{className:"h-32 bg-muted/50 rounded-lg animate-pulse"},N))})]}):k?e.jsx(A,{className:"dark:bg-card dark:border-border",children:e.jsx(R,{className:"p-8 text-center",children:e.jsxs("p",{className:"text-red-500",children:["Error loading players: ",k.message]})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(la,{searchTerm:t,onSearchChange:b,sortBy:i,onSortChange:y,filterOnline:d==="online",onFilterOnlineChange:c=>j(c?"online":"all"),totalResults:t.trim().length>=2?G:p.length}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(w,{variant:"outline",className:"text-lg px-4 py-2 dark:border-muted-foreground",children:t.trim().length>=2?`Found ${G} players for "${t}"`:`Showing ${p.length} players (Page ${T} of ${v})`}),(f||_)&&e.jsxs(w,{variant:"secondary",className:"text-xs",children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-primary mr-1"}),"Loading..."]}),!f&&!_&&p.length>0&&t.trim().length<2&&e.jsxs(w,{variant:"secondary",className:"text-xs",children:[p.length," per page • ",P," total players"]})]}),t.trim().length<2&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"pageSize",className:"text-sm text-muted-foreground",children:"Players per page:"}),e.jsxs("select",{id:"pageSize",value:s,onChange:c=>x(Number(c.target.value)),className:"px-2 py-1 text-sm border rounded-md bg-background dark:bg-background dark:border-border",children:[e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:200,children:"200"})]})]})]}),t.trim().length>=2&&e.jsx("div",{className:"mb-6",children:e.jsx(ca,{players:B,loading:_,searchTerm:t,onPlayerClick:U})}),t.trim().length<2&&e.jsx(da,{profiles:p,onPlayerClick:U,allResidents:re||[],searchTerm:t,statusFilter:d,showDetailedStats:o,onlinePlayers:le,sortBy:i}),t.trim().length<2&&v>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:ie,disabled:r===0||f,children:e.jsx(ra,{className:"w-4 h-4"})}),e.jsx(S,{variant:"outline",size:"sm",onClick:oe,disabled:r===0||f,children:f?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-primary border-t-transparent mr-1"}):e.jsxs(e.Fragment,{children:[e.jsx(sa,{className:"w-4 h-4"}),"Previous"]})}),e.jsxs("div",{className:"flex items-center gap-2 px-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",T," of ",v]}),f&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-primary border-t-transparent"}),v>10&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Jump to:"}),e.jsx("input",{type:"number",min:"1",max:v,value:T,onChange:c=>{const N=parseInt(c.target.value)-1;N>=0&&N<v&&F(N)},className:"w-16 px-2 py-1 text-xs border rounded-md bg-background dark:bg-background dark:border-border"})]})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:me,disabled:r>=v-1||f||!L,children:f?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-primary border-t-transparent mr-1"}):e.jsxs(e.Fragment,{children:["Next",e.jsx(Ve,{className:"w-4 h-4"})]})}),e.jsx(S,{variant:"outline",size:"sm",onClick:de,disabled:r>=v-1||f,children:e.jsx(ta,{className:"w-4 h-4"})})]}),t.trim().length<2&&v<=1&&P>0&&e.jsxs("div",{className:"text-center text-sm text-muted-foreground mt-4",children:["Showing all ",P," players"]}),p.length===0&&!f&&t.trim().length<2&&e.jsx(A,{className:"dark:bg-card dark:border-border",children:e.jsx(R,{className:"p-8 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No players found."})})}),n&&e.jsx(De,{profile:n,onClose:ce})]})},Oa=()=>{const[a]=ee(),m=a.get("player"),n=Ke(),u=ae(),t=()=>n.pathname==="/community/nations"?"nations":n.pathname==="/community/towns"?"towns":(n.pathname==="/community/players","players"),[b,i]=g.useState(t()),y=d=>{switch(i(d),d){case"nations":u("/community/nations");break;case"towns":u("/community/towns");break;case"players":u("/community/players");break}};return e.jsx("div",{className:"min-h-screen bg-background py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs(Ye,{value:b,onValueChange:d=>y(d),className:"w-full",children:[e.jsxs(qe,{className:"flex justify-center gap-2 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950/20 dark:to-purple-950/20 rounded-xl p-1 w-full max-w-2xl mx-auto border border-blue-200 dark:border-blue-800 shadow-lg",children:[e.jsxs(O,{value:"players",className:"flex items-center gap-2 px-6 py-3 rounded-lg text-base font-semibold data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-purple-500 data-[state=active]:text-white data-[state=active]:shadow-lg transition-all duration-300 hover:bg-blue-100 dark:hover:bg-blue-900/20 hover:scale-105",children:[e.jsx(We,{className:"w-4 h-4"}),"Players"]}),e.jsxs(O,{value:"towns",className:"flex items-center gap-2 px-6 py-3 rounded-lg text-base font-semibold data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-purple-500 data-[state=active]:text-white data-[state=active]:shadow-lg transition-all duration-300 hover:bg-blue-100 dark:hover:bg-blue-900/20 hover:scale-105",children:[e.jsx(Q,{className:"w-4 h-4"}),"Towns"]}),e.jsxs(O,{value:"nations",className:"flex items-center gap-2 px-6 py-3 rounded-lg text-base font-semibold data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-purple-500 data-[state=active]:text-white data-[state=active]:shadow-lg transition-all duration-300 hover:bg-blue-100 dark:hover:bg-blue-900/20 hover:scale-105",children:[e.jsx(X,{className:"w-4 h-4"}),"Nations"]})]}),e.jsx(z,{value:"players",className:"mt-6",children:e.jsx(ma,{selectedPlayer:m})}),e.jsx(z,{value:"towns",className:"mt-6",children:e.jsx(Ze,{})}),e.jsx(z,{value:"nations",className:"mt-6",children:e.jsx(Qe,{})})]})})})})};export{Oa as default};
