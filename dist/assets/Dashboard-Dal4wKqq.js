import{I as F,r as i,j as e,w as d,x as j,y as g,z as m,B as L,v as a,b2 as D,u as Y,ay as O,cb as B,az as P,bd as V,b5 as W,be as $,a5 as E,b7 as q,af as H,cc as J}from"./index-DUDTAd9W.js";import{u as K}from"./use-toast-B0dFMpiE.js";import{C as Q}from"./copy-DxsP4cii.js";import{E as T}from"./external-link-BIoP0QEd.js";import{T as G}from"./trophy-BsUhTMZd.js";import{M as X}from"./mail-BZrSbUag.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=F("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),ee=({playerName:s,className:x})=>{const[f,p]=i.useState(!1),{toast:N}=K(),n=`${window.location.origin}/community?player=${encodeURIComponent(s)}`,k=async()=>{try{await navigator.clipboard.writeText(n),p(!0),N({title:"Profile URL copied!",description:"You can now share your profile link with others."}),setTimeout(()=>p(!1),2e3)}catch(y){console.error("Failed to copy to clipboard:",y),N({title:"Failed to copy",description:"Please copy the URL manually.",variant:"destructive"})}},v=()=>{window.open(n,"_blank")};return e.jsxs(d,{className:x,children:[e.jsx(j,{children:e.jsx(g,{className:"flex items-center text-lg",children:"Share Your Profile"})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Your Profile URL"}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded-md",children:[e.jsx("code",{className:"text-xs flex-1 truncate",children:n}),e.jsx(L,{variant:"secondary",className:"text-xs",children:"Public"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{onClick:k,size:"sm",className:"flex-1",disabled:f,children:f?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Copy Link"]})}),e.jsxs(a,{onClick:v,variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"View Profile"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Anyone with this link can view your public profile and stats."})]})]})},ce=()=>{const[s,x]=i.useState(null),[f,p]=i.useState(!0),[N,n]=i.useState(!1),[k,v]=i.useState("profile"),[y,w]=i.useState(!1),r=Y(),{signOut:A,isAuthenticated:C,user:se,profile:c,isTokenLinkUser:h}=O();i.useEffect(()=>{var U,_;const l=localStorage.getItem("tokenlink_profile_id"),b=localStorage.getItem("player_uuid"),o=localStorage.getItem("player_name"),S=localStorage.getItem("profile");if(console.log("Dashboard loading with TokenLink data:",{hasProfileId:!!l,hasUuid:!!b,hasName:!!o,hasProfile:!!S,isAuthenticated:C,hasAuthProfile:!!c}),!C&&(!b||!o)){console.log("No authentication found, redirecting to login"),r("/");return}if(c){console.log("Using auth profile:",c),x(c);const t=(U=c.email)==null?void 0:U.includes("@tokenlink.local");w(t)}else if(S)try{const t=JSON.parse(S);console.log("Loaded TokenLink profile:",t),x(t);const R=(_=t.email)==null?void 0:_.includes("@tokenlink.local");w(R)}catch(t){console.error("Error parsing profile data:",t)}else if(b&&o){const t={id:l||b,email:o+"@tokenlink.local",full_name:o,role:"member",minecraft_username:o};x(t),w(!0)}p(!1)},[r,C,c]);const M=async()=>{console.log("Logging out user"),localStorage.removeItem("tokenlink_profile_id"),localStorage.removeItem("player_uuid"),localStorage.removeItem("player_name"),localStorage.removeItem("profile");try{await A()}catch(l){console.error("Sign out error:",l)}r("/")},z=()=>{const l=(s==null?void 0:s.minecraft_username)||localStorage.getItem("player_name");l&&r(`/community?player=${encodeURIComponent(l)}`)},u=(l="profile")=>{v(l),n(!0)};if(f)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})});const I=(s==null?void 0:s.minecraft_username)||localStorage.getItem("player_name")||"Unknown Player";return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx("h1",{className:"text-xl font-bold",children:"Dashboard"})}),e.jsxs(a,{onClick:M,variant:"outline",size:"sm",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Logout"]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Welcome back, ",I,"!"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account and explore the community"})]}),y&&e.jsx("div",{className:"mb-8",children:e.jsxs(d,{className:"border-orange-200 bg-orange-50",children:[e.jsxs(j,{children:[e.jsxs(g,{className:"flex items-center gap-2 text-orange-800",children:[e.jsx(P,{className:"w-5 h-5"}),"Complete Your Account Setup"]}),e.jsx(CardDescription,{className:"text-orange-700",children:"You're currently logged in via TokenLink authentication from Minecraft"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full"}),e.jsx("span",{className:"text-orange-800",children:"Limited access from other devices"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full"}),e.jsx("span",{className:"text-orange-800",children:"Can't reset password if lost"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full"}),e.jsx("span",{className:"text-orange-800",children:"No email notifications"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(a,{onClick:()=>u("upgrade"),className:"bg-orange-600 hover:bg-orange-700 text-white",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Setup Email & Password"]}),e.jsxs(a,{variant:"outline",onClick:()=>r("/home"),className:"border-orange-300 text-orange-700 hover:bg-orange-100",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Continue to Website"]})]})]})]})}),y&&!h&&e.jsxs(V,{className:"mb-6",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx($,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Complete your account setup by adding an email and password for enhanced security."}),e.jsx(a,{variant:"outline",size:"sm",onClick:()=>u("security"),children:"Setup Now"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(d,{children:[e.jsx(j,{children:e.jsxs(g,{className:"flex items-center",children:[e.jsx(E,{className:"w-5 h-5 mr-2"}),"Profile Information"]})}),e.jsx(m,{className:"space-y-4",children:s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Minecraft Username"}),e.jsx("p",{className:"text-lg font-semibold mt-1",children:s.minecraft_username||s.full_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{className:"text-sm mt-1 font-mono",children:s.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Role"}),e.jsx("div",{className:"mt-1",children:e.jsx(L,{variant:"secondary",className:"capitalize",children:s.role})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Account Type"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(P,{className:"w-4 h-4 text-green-600 mr-1"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:h?"TokenLink":"Standard"}),h&&e.jsx(L,{variant:"outline",className:"ml-2 text-xs",children:"Can be upgraded"})]})]})]})})]}),e.jsx(ee,{playerName:I})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{children:[e.jsx(j,{children:e.jsx(g,{children:"Quick Actions"})}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs(a,{className:"w-full justify-start",onClick:z,children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"View My Profile"]}),e.jsxs(a,{variant:"outline",className:"w-full justify-start",onClick:()=>r("/community"),children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Community"]}),e.jsxs(a,{variant:"outline",className:"w-full justify-start",onClick:()=>r("/forum"),children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Forum"]}),e.jsxs(a,{variant:"outline",className:"w-full justify-start",onClick:()=>u("profile"),children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Edit Profile"]}),e.jsxs(a,{variant:"outline",className:"w-full justify-start",onClick:()=>u("notifications"),children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Preferences"]})]})]}),e.jsxs(d,{children:[e.jsx(j,{children:e.jsx(g,{children:"Account Security"})}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"mb-2",children:h?"Strengthen your TokenLink account:":"Manage your account security:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:h?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"• Add a secure email address"}),e.jsx("li",{children:"• Set a strong password"}),e.jsx("li",{children:"• Enable full website features"})]}):e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"• Change your password"}),e.jsx("li",{children:"• Update your email address"}),e.jsx("li",{children:"• Manage account security"})]})})]}),e.jsxs(a,{variant:"outline",size:"sm",className:"w-full",onClick:()=>u("security"),children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Security Settings"]})]})]})]})]}),e.jsx("div",{className:"mt-12 text-center",children:e.jsx(d,{className:"max-w-md mx-auto border-green-200 bg-green-50",children:e.jsxs(m,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Ready to explore?"}),e.jsx("p",{className:"text-green-700 text-sm mb-4",children:"Continue to the main website to access all features"}),e.jsxs(a,{onClick:()=>r("/home"),className:"bg-green-600 hover:bg-green-700 text-white w-full",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Continue to Website"]})]})})})]}),e.jsx(J,{open:N,onClose:()=>n(!1),defaultTab:k})]})};export{ce as default};
