import{I as S,bu as D,bv as xe,bw as G,bx as Ce,by as ot,bz as Re,bA as lt,aW as Xe,bB as fe,a3 as ze,bl as dt,j as e,l as mt,m as ut,n as ht,B as M,a4 as ge,bC as Qe,F as Ne,aG as A,H as J,a5 as ce,bD as Ve,a6 as ke,a7 as oe,G as $,a8 as H,Q as xt,a9 as ft,aa as E,ab as gt,ac as jt,ad as pt,ae as T,af as bt,ag as wt,ah as vt,ai as yt,aj as ye,ak as _t,al as Nt,am as K,an as kt,bE as Ke,aV as Ct,w as N,z as C,x as P,y as O,u as Ze,M as je,v as F,br as Mt,r as y,s as q,aF as ee,o as le,p as de,q as me,t as ue,at as Je,au as et,av as z,aw as Q,ay as tt,b6 as _e,az as ne,W as St,X as Pt,Z as Me,$ as Se,a0 as Pe,a1 as Oe,a2 as te,aB as Ot,aC as Tt,bg as At,aD as Dt,aE as Et,bF as Wt,bG as Lt,S as Ft,bH as Bt,bI as Yt,ba as $t,bJ as qt}from"./index-DUDTAd9W.js";import{B as W}from"./building-D338Q9pK.js";import{D as It}from"./dollar-sign-C05urchb.js";import{T as L}from"./trophy-BsUhTMZd.js";import{u as Ht}from"./use-toast-B0dFMpiE.js";import{M as R,C as st}from"./mountain-dX0sFwjD.js";import{P as X}from"./package-8K7nsPFD.js";import{P as Te}from"./pickaxe-Db78WbHr.js";import{C as pe}from"./coins-DnpU2Pgu.js";import{G as se,F as Gt}from"./gem-D6ORsYQo.js";import{T as be}from"./target-Bz-_XMXs.js";import{F as Ut}from"./filter-WGNF5-0m.js";import{A as Ae}from"./arrow-left-BF2Td8_J.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=S("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=S("Apple",[["path",{d:"M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z",key:"3s7exb"}],["path",{d:"M10 2c1 .5 2 2 2 5",key:"fcco2y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=S("BedDouble",[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=S("Beef",[["circle",{cx:"12.5",cy:"8.5",r:"2.5",key:"9738u8"}],["path",{d:"M12.5 2a6.5 6.5 0 0 0-6.22 4.6c-1.1 3.13-.78 3.9-3.18 6.08A3 3 0 0 0 5 18c4 0 8.4-1.8 11.4-4.3A6.5 6.5 0 0 0 12.5 2Z",key:"o0f6za"}],["path",{d:"m18.5 6 2.19 4.5a6.48 6.48 0 0 1 .31 2 6.49 6.49 0 0 1-2.6 5.2C15.4 20.2 11 22 7 22a3 3 0 0 1-2.68-1.66L2.4 16.5",key:"k7p6i0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=S("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=S("Carrot",[["path",{d:"M2.27 21.7s9.87-3.5 12.73-6.36a4.5 4.5 0 0 0-6.36-6.37C5.77 11.84 2.27 21.7 2.27 21.7zM8.64 14l-2.05-2.04M15.34 15l-2.46-2.46",key:"rfqxbe"}],["path",{d:"M22 9s-1.33-2-3.5-2C16.86 7 15 9 15 9s1.33 2 3.5 2S22 9 22 9z",key:"6b25w4"}],["path",{d:"M15 2s-2 1.33-2 3.5S15 9 15 9s2-1.84 2-3.5C17 3.33 15 2 15 2z",key:"fn65lo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=S("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=S("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=S("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=S("Diamond",[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=S("Footprints",[["path",{d:"M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z",key:"1dudjm"}],["path",{d:"M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z",key:"l2t8xc"}],["path",{d:"M16 17h4",key:"1dejxt"}],["path",{d:"M4 13h4",key:"1bwh8b"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=S("Milk",[["path",{d:"M8 2h8",key:"1ssgc1"}],["path",{d:"M9 2v2.789a4 4 0 0 1-.672 2.219l-.656.984A4 4 0 0 0 7 10.212V20a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-9.789a4 4 0 0 0-.672-2.219l-.656-.984A4 4 0 0 1 15 4.788V2",key:"qtp12x"}],["path",{d:"M7 15a6.472 6.472 0 0 1 5 0 6.47 6.47 0 0 0 5 0",key:"ygeh44"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=S("Ship",[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=S("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]);function Z(s,t){var g,m,d,o;const a=xe(),r=(t==null?void 0:t.weekStartsOn)??((m=(g=t==null?void 0:t.locale)==null?void 0:g.options)==null?void 0:m.weekStartsOn)??a.weekStartsOn??((o=(d=a.locale)==null?void 0:d.options)==null?void 0:o.weekStartsOn)??0,n=D(s),i=n.getDay(),x=(i<r?7:0)+i-r;return n.setDate(n.getDate()-x),n.setHours(0,0,0,0),n}function he(s){return Z(s,{weekStartsOn:1})}function nt(s){const t=D(s),a=t.getFullYear(),r=G(s,0);r.setFullYear(a+1,0,4),r.setHours(0,0,0,0);const n=he(r),i=G(s,0);i.setFullYear(a,0,4),i.setHours(0,0,0,0);const x=he(i);return t.getTime()>=n.getTime()?a+1:t.getTime()>=x.getTime()?a:a-1}function Le(s){const t=D(s);return t.setHours(0,0,0,0),t}function Kt(s,t){const a=Le(s),r=Le(t),n=+a-Ce(a),i=+r-Ce(r);return Math.round((n-i)/ot)}function Zt(s){const t=nt(s),a=G(s,0);return a.setFullYear(t,0,4),a.setHours(0,0,0,0),he(a)}function Jt(s){return s instanceof Date||typeof s=="object"&&Object.prototype.toString.call(s)==="[object Date]"}function es(s){if(!Jt(s)&&typeof s!="number")return!1;const t=D(s);return!isNaN(Number(t))}function ts(s){const t=D(s),a=G(s,0);return a.setFullYear(t.getFullYear(),0,1),a.setHours(0,0,0,0),a}function ss(s){const t=D(s);return Kt(t,ts(t))+1}function as(s){const t=D(s),a=+he(t)-+Zt(t);return Math.round(a/Re)+1}function it(s,t){var o,j,h,w;const a=D(s),r=a.getFullYear(),n=xe(),i=(t==null?void 0:t.firstWeekContainsDate)??((j=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:j.firstWeekContainsDate)??n.firstWeekContainsDate??((w=(h=n.locale)==null?void 0:h.options)==null?void 0:w.firstWeekContainsDate)??1,x=G(s,0);x.setFullYear(r+1,0,i),x.setHours(0,0,0,0);const g=Z(x,t),m=G(s,0);m.setFullYear(r,0,i),m.setHours(0,0,0,0);const d=Z(m,t);return a.getTime()>=g.getTime()?r+1:a.getTime()>=d.getTime()?r:r-1}function rs(s,t){var g,m,d,o;const a=xe(),r=(t==null?void 0:t.firstWeekContainsDate)??((m=(g=t==null?void 0:t.locale)==null?void 0:g.options)==null?void 0:m.firstWeekContainsDate)??a.firstWeekContainsDate??((o=(d=a.locale)==null?void 0:d.options)==null?void 0:o.firstWeekContainsDate)??1,n=it(s,t),i=G(s,0);return i.setFullYear(n,0,r),i.setHours(0,0,0,0),Z(i,t)}function ns(s,t){const a=D(s),r=+Z(a,t)-+rs(a,t);return Math.round(r/Re)+1}function b(s,t){const a=s<0?"-":"",r=Math.abs(s).toString().padStart(t,"0");return a+r}const B={y(s,t){const a=s.getFullYear(),r=a>0?a:1-a;return b(t==="yy"?r%100:r,t.length)},M(s,t){const a=s.getMonth();return t==="M"?String(a+1):b(a+1,2)},d(s,t){return b(s.getDate(),t.length)},a(s,t){const a=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(s,t){return b(s.getHours()%12||12,t.length)},H(s,t){return b(s.getHours(),t.length)},m(s,t){return b(s.getMinutes(),t.length)},s(s,t){return b(s.getSeconds(),t.length)},S(s,t){const a=t.length,r=s.getMilliseconds(),n=Math.trunc(r*Math.pow(10,a-3));return b(n,t.length)}},U={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Fe={G:function(s,t,a){const r=s.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})}},y:function(s,t,a){if(t==="yo"){const r=s.getFullYear(),n=r>0?r:1-r;return a.ordinalNumber(n,{unit:"year"})}return B.y(s,t)},Y:function(s,t,a,r){const n=it(s,r),i=n>0?n:1-n;if(t==="YY"){const x=i%100;return b(x,2)}return t==="Yo"?a.ordinalNumber(i,{unit:"year"}):b(i,t.length)},R:function(s,t){const a=nt(s);return b(a,t.length)},u:function(s,t){const a=s.getFullYear();return b(a,t.length)},Q:function(s,t,a){const r=Math.ceil((s.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return b(r,2);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})}},q:function(s,t,a){const r=Math.ceil((s.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return b(r,2);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})}},M:function(s,t,a){const r=s.getMonth();switch(t){case"M":case"MM":return B.M(s,t);case"Mo":return a.ordinalNumber(r+1,{unit:"month"});case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})}},L:function(s,t,a){const r=s.getMonth();switch(t){case"L":return String(r+1);case"LL":return b(r+1,2);case"Lo":return a.ordinalNumber(r+1,{unit:"month"});case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})}},w:function(s,t,a,r){const n=ns(s,r);return t==="wo"?a.ordinalNumber(n,{unit:"week"}):b(n,t.length)},I:function(s,t,a){const r=as(s);return t==="Io"?a.ordinalNumber(r,{unit:"week"}):b(r,t.length)},d:function(s,t,a){return t==="do"?a.ordinalNumber(s.getDate(),{unit:"date"}):B.d(s,t)},D:function(s,t,a){const r=ss(s);return t==="Do"?a.ordinalNumber(r,{unit:"dayOfYear"}):b(r,t.length)},E:function(s,t,a){const r=s.getDay();switch(t){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})}},e:function(s,t,a,r){const n=s.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return b(i,2);case"eo":return a.ordinalNumber(i,{unit:"day"});case"eee":return a.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(n,{width:"short",context:"formatting"});case"eeee":default:return a.day(n,{width:"wide",context:"formatting"})}},c:function(s,t,a,r){const n=s.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return b(i,t.length);case"co":return a.ordinalNumber(i,{unit:"day"});case"ccc":return a.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(n,{width:"narrow",context:"standalone"});case"cccccc":return a.day(n,{width:"short",context:"standalone"});case"cccc":default:return a.day(n,{width:"wide",context:"standalone"})}},i:function(s,t,a){const r=s.getDay(),n=r===0?7:r;switch(t){case"i":return String(n);case"ii":return b(n,t.length);case"io":return a.ordinalNumber(n,{unit:"day"});case"iii":return a.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(r,{width:"short",context:"formatting"});case"iiii":default:return a.day(r,{width:"wide",context:"formatting"})}},a:function(s,t,a){const n=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(s,t,a){const r=s.getHours();let n;switch(r===12?n=U.noon:r===0?n=U.midnight:n=r/12>=1?"pm":"am",t){case"b":case"bb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(s,t,a){const r=s.getHours();let n;switch(r>=17?n=U.evening:r>=12?n=U.afternoon:r>=4?n=U.morning:n=U.night,t){case"B":case"BB":case"BBB":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(s,t,a){if(t==="ho"){let r=s.getHours()%12;return r===0&&(r=12),a.ordinalNumber(r,{unit:"hour"})}return B.h(s,t)},H:function(s,t,a){return t==="Ho"?a.ordinalNumber(s.getHours(),{unit:"hour"}):B.H(s,t)},K:function(s,t,a){const r=s.getHours()%12;return t==="Ko"?a.ordinalNumber(r,{unit:"hour"}):b(r,t.length)},k:function(s,t,a){let r=s.getHours();return r===0&&(r=24),t==="ko"?a.ordinalNumber(r,{unit:"hour"}):b(r,t.length)},m:function(s,t,a){return t==="mo"?a.ordinalNumber(s.getMinutes(),{unit:"minute"}):B.m(s,t)},s:function(s,t,a){return t==="so"?a.ordinalNumber(s.getSeconds(),{unit:"second"}):B.s(s,t)},S:function(s,t){return B.S(s,t)},X:function(s,t,a){const r=s.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return Ye(r);case"XXXX":case"XX":return I(r);case"XXXXX":case"XXX":default:return I(r,":")}},x:function(s,t,a){const r=s.getTimezoneOffset();switch(t){case"x":return Ye(r);case"xxxx":case"xx":return I(r);case"xxxxx":case"xxx":default:return I(r,":")}},O:function(s,t,a){const r=s.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Be(r,":");case"OOOO":default:return"GMT"+I(r,":")}},z:function(s,t,a){const r=s.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Be(r,":");case"zzzz":default:return"GMT"+I(r,":")}},t:function(s,t,a){const r=Math.trunc(s.getTime()/1e3);return b(r,t.length)},T:function(s,t,a){const r=s.getTime();return b(r,t.length)}};function Be(s,t=""){const a=s>0?"-":"+",r=Math.abs(s),n=Math.trunc(r/60),i=r%60;return i===0?a+String(n):a+String(n)+t+b(i,2)}function Ye(s,t){return s%60===0?(s>0?"-":"+")+b(Math.abs(s)/60,2):I(s,t)}function I(s,t=""){const a=s>0?"-":"+",r=Math.abs(s),n=b(Math.trunc(r/60),2),i=b(r%60,2);return a+n+t+i}const $e=(s,t)=>{switch(s){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},ct=(s,t)=>{switch(s){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},is=(s,t)=>{const a=s.match(/(P+)(p+)?/)||[],r=a[1],n=a[2];if(!n)return $e(s,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",$e(r,t)).replace("{{time}}",ct(n,t))},cs={p:ct,P:is},os=/^D+$/,ls=/^Y+$/,ds=["D","DD","YY","YYYY"];function ms(s){return os.test(s)}function us(s){return ls.test(s)}function hs(s,t,a){const r=xs(s,t,a);if(console.warn(r),ds.includes(s))throw new RangeError(r)}function xs(s,t,a){const r=s[0]==="Y"?"years":"days of the month";return`Use \`${s.toLowerCase()}\` instead of \`${s}\` (in \`${t}\`) for formatting ${r} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const fs=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,gs=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,js=/^'([^]*?)'?$/,ps=/''/g,bs=/[a-zA-Z]/;function ws(s,t,a){var o,j,h,w;const r=xe(),n=r.locale??lt,i=r.firstWeekContainsDate??((j=(o=r.locale)==null?void 0:o.options)==null?void 0:j.firstWeekContainsDate)??1,x=r.weekStartsOn??((w=(h=r.locale)==null?void 0:h.options)==null?void 0:w.weekStartsOn)??0,g=D(s);if(!es(g))throw new RangeError("Invalid time value");let m=t.match(gs).map(c=>{const f=c[0];if(f==="p"||f==="P"){const _=cs[f];return _(c,n.formatLong)}return c}).join("").match(fs).map(c=>{if(c==="''")return{isToken:!1,value:"'"};const f=c[0];if(f==="'")return{isToken:!1,value:vs(c)};if(Fe[f])return{isToken:!0,value:c};if(f.match(bs))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:c}});n.localize.preprocessor&&(m=n.localize.preprocessor(g,m));const d={firstWeekContainsDate:i,weekStartsOn:x,locale:n};return m.map(c=>{if(!c.isToken)return c.value;const f=c.value;(us(f)||ms(f))&&hs(f,t,String(s));const _=Fe[f[0]];return _(g,f,n.localize,d)}).join("")}function vs(s){const t=s.match(js);return t?t[1].replace(ps,"'"):s}const re={User:e.jsx(ce,{className:"w-3 h-3"}),Star:e.jsx(ge,{className:"w-3 h-3"}),Hammer:e.jsx(Ve,{className:"w-3 h-3"}),Award:e.jsx(ke,{className:"w-3 h-3"}),Sparkles:e.jsx(oe,{className:"w-3 h-3"}),Crown:e.jsx($,{className:"w-3 h-3"}),Heart:e.jsx(H,{className:"w-3 h-3"}),Globe:e.jsx(xt,{className:"w-3 h-3"}),Book:e.jsx(ft,{className:"w-3 h-3"}),Wrench:e.jsx(E,{className:"w-3 h-3"}),Flame:e.jsx(gt,{className:"w-3 h-3"}),Sun:e.jsx(jt,{className:"w-3 h-3"}),Moon:e.jsx(pt,{className:"w-3 h-3"}),Zap:e.jsx(T,{className:"w-3 h-3"}),Key:e.jsx(bt,{className:"w-3 h-3"}),Lock:e.jsx(wt,{className:"w-3 h-3"}),Smile:e.jsx(vt,{className:"w-3 h-3"}),Ghost:e.jsx(yt,{className:"w-3 h-3"}),Skull:e.jsx(ye,{className:"w-3 h-3"}),Leaf:e.jsx(_t,{className:"w-3 h-3"}),Rocket:e.jsx(Nt,{className:"w-3 h-3"}),Sword:e.jsx(K,{className:"w-3 h-3"}),Wand2:e.jsx(kt,{className:"w-3 h-3"}),Medal:e.jsx(Ke,{className:"w-3 h-3"}),MapPin:e.jsx(J,{className:"w-3 h-3"})},ys={"Golden Kala":{color:"from-amber-400 via-yellow-500 to-orange-600",borderColor:"border-amber-400",glowColor:"shadow-amber-400/50",banner:"bg-gradient-to-r from-amber-400 via-yellow-500 to-orange-600",icon:e.jsx($,{className:"w-5 h-5 text-amber-400"}),effects:["animate-pulse","shadow-lg"],benefits:["€5 passive income","25% Treasure Chest discount","Exclusive cosmetics","Priority support"]},"Fancy Kala":{color:"from-red-400 via-pink-500 to-purple-600",borderColor:"border-red-400",glowColor:"shadow-red-400/50",banner:"bg-gradient-to-r from-red-400 via-pink-500 to-purple-600",icon:e.jsx(oe,{className:"w-5 h-5 text-red-400"}),effects:["animate-bounce"],benefits:["€4.5 passive income","20% Treasure Chest discount","Enhanced cosmetics","Priority support"]},Kala:{color:"from-orange-400 via-red-500 to-pink-600",borderColor:"border-orange-400",glowColor:"shadow-orange-400/50",banner:"bg-gradient-to-r from-orange-400 via-red-500 to-pink-600",icon:e.jsx(ge,{className:"w-5 h-5 text-orange-400"}),effects:["animate-pulse"],benefits:["€4 passive income","15% Treasure Chest discount","Special cosmetics","Priority support"]}},_s=({profile:s})=>{var u;const{data:t}=Xe(s.id),{data:a}=fe(s.username),{onlinePlayers:r}=ze(),n=r.some(l=>l.name&&typeof l.name=="string"&&l.name.toLowerCase()===s.username.toLowerCase()),i=t==null?void 0:t.find(l=>["Golden Kala","Fancy Kala","Kala"].includes(l.badge_type)),x=i?ys[i.badge_type]:null,g=l=>{try{const p=new Date(l);return ws(p,"PPP")}catch{return"Unknown"}},m=l=>{try{const p=new Date(l);return Ct(p,{addSuffix:!0})}catch{return"Unknown"}},d=s.levelInfo||dt(((u=s.levelInfo)==null?void 0:u.totalXp)||0),o={level:(d==null?void 0:d.level)||1,totalXp:(d==null?void 0:d.totalXp)||0,xpInCurrentLevel:(d==null?void 0:d.xpInCurrentLevel)||0,xpForNextLevel:(d==null?void 0:d.xpForNextLevel)||100,progress:(d==null?void 0:d.progress)||0,title:(d==null?void 0:d.title)||"Newcomer",description:(d==null?void 0:d.description)||"Welcome to the server!",color:(d==null?void 0:d.color)||"#6b7280"},j=s.isWebsiteUser?"Member":"Player",h=j==="Member"?re.Star:re.User,w=j==="Member"?"#22c55e":"#6b7280",c=(a==null?void 0:a.registered)||s.joinDate,f=(a==null?void 0:a.last_login)||s.lastSeen,_=(a==null?void 0:a.town_name)||s.town||"Wanderer";return e.jsxs("div",{className:"space-y-6",children:[x&&e.jsxs("div",{className:`${x.banner} text-white p-4 rounded-lg shadow-lg relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 bg-black/20"}),e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[x.icon,e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:i==null?void 0:i.badge_type}),e.jsx("p",{className:"text-sm opacity-90",children:"Premium Patron Member"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm opacity-90",children:"Active Benefits"}),e.jsx("div",{className:"text-lg font-bold",children:x.benefits[0]})]})]}),e.jsx("div",{className:"absolute top-2 right-2 opacity-30",children:e.jsx("div",{className:"animate-bounce",children:"✨"})}),e.jsx("div",{className:"absolute bottom-2 left-2 opacity-30",children:e.jsx("div",{className:"animate-pulse",children:"⭐"})})]}),e.jsx("div",{className:`flex flex-col md:flex-row gap-6 items-start p-6 rounded-lg ${x?`${x.borderColor} border-2 ${x.glowColor} shadow-xl`:"bg-card/50"}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`relative ${x?"group":""}`,children:[e.jsxs(mt,{className:`h-20 w-20 ${x?x.effects.join(" "):""}`,children:[e.jsx(ut,{src:s.avatar,alt:s.username}),e.jsx(ht,{className:"text-2xl",children:s.username.charAt(0).toUpperCase()})]}),x&&e.jsx("div",{className:`absolute -inset-2 rounded-full bg-gradient-to-r ${x.color} opacity-75 blur-sm group-hover:opacity-100 transition-opacity duration-300`}),n&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-green-500 rounded-full border-2 border-white dark:border-gray-800 animate-pulse"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${x?"bg-gradient-to-r from-white to-gray-200 bg-clip-text text-transparent":""}`,children:s.displayName||s.username}),s.displayName&&s.displayName!==s.username&&e.jsxs("p",{className:"text-lg text-muted-foreground",children:["@",s.username]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{variant:n?"default":"secondary",children:n?"Online":"Offline"}),e.jsxs(M,{style:{backgroundColor:o.color,color:"white"},className:"text-sm flex items-center gap-1",children:[e.jsx(ge,{className:"w-3 h-3"}),"Level ",o.level]}),e.jsx("span",{className:"text-sm font-medium",style:{color:o.color},children:o.title})]}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:t&&t.length>0?t.map(l=>{const p=re[l.icon]||re.User,v=["Golden Kala","Fancy Kala","Kala"].includes(l.badge_type);return e.jsxs(M,{style:{backgroundColor:l.badge_color,color:"white"},className:`text-xs flex items-center gap-1 ${v?"ring-2 ring-white/50 shadow-lg":""}`,children:[p,!l.icon_only&&e.jsx("span",{children:l.badge_type})]},l.id)}):s.isWebsiteUser&&e.jsxs(M,{style:{backgroundColor:w,color:"white"},className:"text-xs flex items-center gap-1",children:[h,e.jsx("span",{children:j})]})}),x&&e.jsxs("div",{className:"bg-gradient-to-r from-white/10 to-white/5 p-3 rounded-lg border border-white/20",children:[e.jsx("div",{className:"text-sm font-medium text-white mb-2",children:"Patron Benefits:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:x.benefits.map((l,p)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-green-300",children:"✓"}),e.jsx("span",{className:"text-white/90",children:l})]},p))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[o.totalXp.toLocaleString()," XP"]}),e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsxs("span",{className:"text-muted-foreground",children:[o.xpInCurrentLevel.toLocaleString()," / ",o.xpForNextLevel.toLocaleString()]}),e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsxs("span",{className:"text-muted-foreground",children:["Progress to Level ",o.level+1]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[o.progress.toFixed(1),"%"]})]}),e.jsx(Qe,{value:o.progress,className:"h-2"})]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Joined:"}),e.jsx("span",{className:"font-medium",children:g(c)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Last seen:"}),e.jsx("span",{className:"font-medium",children:m(f)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Location:"}),e.jsx("span",{className:"font-medium",children:_})]})]})]})},Ns=({profile:s})=>{const{data:t}=fe(s.username),a=(t==null?void 0:t.registered)||s.joinDate,r=(t==null?void 0:t.town_name)||s.town||"Wanderer";return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(N,{className:"glass-card",children:e.jsxs(C,{className:"p-4 text-center",children:[e.jsx(Ne,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Joined"}),e.jsx("div",{className:"font-medium",children:new Date(a).toLocaleDateString()})]})}),e.jsx(N,{className:"glass-card",children:e.jsxs(C,{className:"p-4 text-center",children:[e.jsx(A,{className:"w-6 h-6 mx-auto mb-2 text-secondary"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Last Active"}),e.jsx("div",{className:"font-medium",children:new Date(s.lastSeen).toLocaleDateString()})]})}),e.jsx(N,{className:"glass-card",children:e.jsxs(C,{className:"p-4 text-center",children:[e.jsx(J,{className:"w-6 h-6 mx-auto mb-2 text-accent"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Location"}),e.jsx("div",{className:"font-medium",children:r})]})})]})},ks=({bio:s})=>s?e.jsxs(N,{className:"glass-card",children:[e.jsx(P,{children:e.jsxs(O,{className:"flex items-center",children:[e.jsx(ce,{className:"w-5 h-5 mr-2"}),"About"]})}),e.jsx(C,{children:e.jsx("p",{className:"text-muted-foreground",children:s})})]}):e.jsxs(N,{className:"glass-card",children:[e.jsx(P,{children:e.jsxs(O,{className:"flex items-center",children:[e.jsx(ce,{className:"w-5 h-5 mr-2"}),"About"]})}),e.jsx(C,{children:e.jsx("p",{className:"text-muted-foreground",children:"No bio available."})})]}),Cs=({profile:s,isAuthenticated:t,onContactClick:a})=>{const r=Ze();return s.discord||s.isWebsiteUser&&s.websiteUserId?e.jsxs(N,{className:"glass-card",children:[e.jsx(P,{children:e.jsxs(O,{className:"flex items-center",children:[e.jsx(je,{className:"w-5 h-5 mr-2"}),"Contact"]})}),e.jsxs(C,{className:"space-y-3",children:[s.discord&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Discord:"}),e.jsx("span",{className:"font-medium",children:s.discord})]}),s.isWebsiteUser&&s.websiteUserId&&t&&e.jsxs(F,{variant:"outline",className:"w-full",onClick:()=>{r(`/messages?with=${encodeURIComponent(s.websiteUserId)}`)},children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Send Message"]}),s.isWebsiteUser&&s.websiteUserId&&!t&&e.jsxs(F,{variant:"outline",className:"w-full",onClick:a,title:"Log in to send messages",children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Send Message (Log in required)"]}),!s.isWebsiteUser&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"This player cannot be contacted via the website."})]})]}):null},Ms=({profile:s})=>{const{data:t,loading:a,error:r}=fe(s.username),{onlinePlayers:n}=ze(),i=n.some(o=>o.name&&typeof o.name=="string"&&o.name.toLowerCase()===s.username.toLowerCase()),x=o=>o>=400?{label:"Established",color:"text-green-600",bgColor:"bg-green-50"}:o>=200?{label:"Active",color:"text-blue-600",bgColor:"bg-blue-50"}:o>=100?{label:"Regular",color:"text-gray-600",bgColor:"bg-gray-50"}:{label:"New",color:"text-gray-500",bgColor:"bg-gray-50"},g=o=>{try{return new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"Unknown"}},m=o=>{try{const j=new Date(o),w=new Date().getTime()-j.getTime(),c=Math.floor(w/(1e3*60*60*24));return c===0?"Today":c===1?"Yesterday":c<7?`${c} days ago`:c<30?`${Math.floor(c/7)} weeks ago`:c<365?`${Math.floor(c/30)} months ago`:`${Math.floor(c/365)} years ago`}catch{return"Unknown"}};if(a)return e.jsxs(N,{className:"glass-card",children:[e.jsx(P,{children:e.jsxs(O,{className:"flex items-center",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),"Political Info"]})}),e.jsx(C,{children:e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})})})]});if(r)return e.jsxs(N,{className:"glass-card",children:[e.jsx(P,{children:e.jsxs(O,{className:"flex items-center",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),"Political Info"]})}),e.jsx(C,{children:e.jsxs("div",{className:"text-red-500 text-sm",children:["Error loading player data: ",r]})})]});const d=t?x(t.activity_score):null;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(N,{className:"glass-card",children:[e.jsx(P,{children:e.jsxs(O,{className:"flex items-center",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),"Political Info"]})}),e.jsxs(C,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Nation:"]}),e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.nation_name)||s.nation||"None"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Town:"]}),e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.town_name)||s.town||"None"})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[(t==null?void 0:t.is_king)&&e.jsxs(M,{variant:"default",className:"bg-purple-600 text-white",children:[e.jsx($,{className:"w-3 h-3 mr-1"}),"King"]}),(t==null?void 0:t.is_mayor)&&e.jsxs(M,{variant:"default",className:"bg-yellow-600 text-white",children:[e.jsx($,{className:"w-3 h-3 mr-1"}),"Mayor"]})]})]})]}),e.jsxs(N,{className:"glass-card",children:[e.jsx(P,{children:e.jsxs(O,{className:"flex items-center",children:[e.jsx(Rt,{className:"w-5 h-5 mr-2"}),"Activity Info"]})}),e.jsxs(C,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Influence Score:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.activity_score)||"N/A"}),d&&e.jsxs("span",{className:`text-sm ${d.color}`,children:[d.label," member"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:i?"default":"secondary",children:i?"Online":"Offline"}),i&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"})]})]})]})]}),e.jsxs(N,{className:"glass-card",children:[e.jsx(P,{children:e.jsxs(O,{className:"flex items-center",children:[e.jsx(Ne,{className:"w-5 h-5 mr-2"}),"Timeline"]})}),e.jsxs(C,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Registered:"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium",children:t!=null&&t.registered?g(t.registered):"Unknown"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t!=null&&t.registered?m(t.registered):""})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Login:"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium",children:t!=null&&t.last_login?g(t.last_login):g(s.lastSeen)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t!=null&&t.last_login?m(t.last_login):m(s.lastSeen)})]})]})]})]}),e.jsxs(N,{className:"glass-card",children:[e.jsx(P,{children:e.jsxs(O,{className:"flex items-center",children:[e.jsx(It,{className:"w-5 h-5 mr-2"}),"Economy"]})}),e.jsx(C,{className:"space-y-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Balance:"}),e.jsxs("span",{className:"font-medium text-lg",children:["$",((t==null?void 0:t.balance)||s.stats.balance||0).toLocaleString()]})]})})]})]})},Ss=({stats:s,onViewAllStats:t,loading:a})=>a?e.jsx("div",{className:"text-center py-8",children:"Loading player statistics..."}):e.jsxs(N,{className:"rounded-2xl",children:[e.jsx(P,{children:e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(Mt,{className:"w-5 h-5 text-amber-500"}),"Statistics (Work in progress)"]})}),e.jsx(C,{children:e.jsx("p",{className:"text-muted-foreground",children:"We’re rebuilding the statistics experience. Current data is unreliable and this section is temporarily disabled."})})]}),qe=({isOpen:s,onClose:t,playerUuid:a,playerName:r})=>{const[n,i]=y.useState([]),[x,g]=y.useState([]),[m,d]=y.useState(!1);y.useEffect(()=>{s&&a&&o()},[s,a]);const o=async()=>{d(!0);try{const{data:c,error:f}=await q.rpc("get_claimable_achievements",{p_player_uuid:a});if(f)throw f;const{data:_,error:u}=await q.from("unlocked_achievements").select(`
          *,
          achievement_tiers(
            id,
            name,
            description,
            points,
            tier,
            threshold,
            achievement_definitions(
              id,
              name,
              achievement_type
            )
          )
        `).eq("player_uuid",a);if(u)throw u;i(c||[]),g(_||[])}catch(c){console.error("Error fetching achievements:",c),ee.error("Failed to load achievements")}finally{d(!1)}},j=async c=>{try{const{data:f,error:_}=await q.functions.invoke("claim-achievement",{body:{player_uuid:a,tier_id:c}});if(_)throw _;f.success?(ee.success(`Achievement claimed! +${f.xp_awarded} XP`),o()):ee.error(f.message||"Failed to claim achievement")}catch(f){console.error("Error claiming achievement:",f),ee.error("Failed to claim achievement")}},h=(c,f)=>Math.min(c/f*100,100),w=c=>{switch(c){case 1:return e.jsx(L,{className:"h-4 w-4 text-bronze"});case 2:return e.jsx(L,{className:"h-4 w-4 text-gray-400"});case 3:return e.jsx(L,{className:"h-4 w-4 text-yellow-500"});default:return e.jsx(ge,{className:"h-4 w-4"})}};return e.jsx(le,{open:s,onOpenChange:t,children:e.jsxs(de,{className:"max-w-4xl max-h-[80vh] overflow-hidden",children:[e.jsx(me,{children:e.jsxs(ue,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5"}),r,"'s Achievements"]})}),m?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs(Je,{defaultValue:"available",className:"w-full",children:[e.jsxs(et,{className:"grid w-full grid-cols-2",children:[e.jsx(z,{value:"available",children:"Available"}),e.jsx(z,{value:"unlocked",children:"Unlocked"})]}),e.jsx(Q,{value:"available",className:"space-y-4 max-h-[50vh] overflow-y-auto",children:n.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No achievements available to claim"})}):n.map(c=>e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[w(c.tier_number),e.jsx("h3",{className:"font-semibold",children:c.achievement_name}),e.jsxs(M,{variant:"outline",children:["Tier ",c.tier_number]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:c.tier_description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[c.current_value," / ",c.threshold]})]}),e.jsx(Qe,{value:h(c.current_value,c.threshold),className:"h-2"})]})]}),e.jsxs("div",{className:"ml-4 text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-primary",children:["+",c.points," XP"]}),c.is_claimable&&e.jsx(F,{size:"sm",onClick:()=>j(c.tier_id),className:"mt-2",children:"Claim"})]})]})},c.tier_id))}),e.jsx(Q,{value:"unlocked",className:"space-y-4 max-h-[50vh] overflow-y-auto",children:x.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No achievements unlocked yet"})}):x.map(c=>{var f,_,u,l,p;return e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(L,{className:"h-4 w-4 text-yellow-500"}),e.jsx("h3",{className:"font-semibold",children:(_=(f=c.achievement_tiers)==null?void 0:f.achievement_definitions)==null?void 0:_.name}),e.jsxs(M,{variant:"outline",children:["Tier ",(u=c.achievement_tiers)==null?void 0:u.tier]}),c.is_claimed&&e.jsx(M,{variant:"default",children:"Claimed"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:(l=c.achievement_tiers)==null?void 0:l.description}),c.unlocked_at&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(A,{className:"h-3 w-3"}),"Unlocked ",new Date(c.unlocked_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"ml-4 text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-primary",children:["+",(p=c.achievement_tiers)==null?void 0:p.points," XP"]}),!c.is_claimed&&e.jsx(F,{size:"sm",onClick:()=>{var v;return j((v=c.achievement_tiers)==null?void 0:v.id)},className:"mt-2",children:"Claim"})]})]})},c.id)})})]})]})})},Ps=()=>{const[s,t]=y.useState(!1),[a,r]=y.useState([]),{toast:n}=Ht(),i=y.useCallback(async m=>{if(!m)return console.warn("No playerUuid provided to fetchClaimableAchievements"),[];try{console.log("Fetching claimable achievements for player:",m);const{data:d,error:o}=await q.rpc("get_claimable_achievements",{p_player_uuid:m});if(o)throw console.error("Supabase RPC error:",o),o;console.log("Raw claimable achievements data:",d);const j=(d||[]).map(h=>({tier_id:h.tier_id,achievement_id:h.achievement_id,achievement_name:h.achievement_name,tier_name:h.tier_name,tier_description:h.tier_description,points:h.points,tier_number:h.tier_number,current_value:h.current_value,threshold:h.threshold,is_claimable:h.is_claimable}));return r(j),console.log("DEBUG: Claimable achievements processed:",{playerUuid:m,total:j.length,claimable:j.filter(h=>h.is_claimable).length,claimableAchievements:j.filter(h=>h.is_claimable),allAchievements:j}),j}catch(d){return console.error("Error fetching claimable achievements:",d),n({title:"Error",description:"Failed to fetch claimable achievements",variant:"destructive"}),[]}},[n]),x=y.useCallback(async(m,d)=>{t(!0);try{const{data:o,error:j}=await q.rpc("claim_achievement",{p_player_uuid:m,p_tier_id:d});if(j)throw j;const h=o;return h.success?(n({title:"Achievement Claimed! 🎉",description:`You earned ${h.xp_awarded} XP for ${h.achievement_name} - ${h.tier_name}!`}),await i(m)):n({title:"Error",description:h.message||"Failed to claim achievement",variant:"destructive"}),h}catch(o){console.error("Error claiming achievement:",o);const j={success:!1,message:"An error occurred while claiming the achievement"};return n({title:"Error",description:j.message,variant:"destructive"}),j}finally{t(!1)}},[n,i]),g=y.useCallback(async(m,d,o)=>{t(!0);try{const{data:j,error:h}=await q.rpc("admin_claim_achievement",{p_admin_user_id:m,p_player_uuid:d,p_tier_id:o});if(h)throw h;const w=j;return w.success?(n({title:"Achievement Claimed (Admin) 🎉",description:`Awarded ${w.xp_awarded} XP for ${w.achievement_name} - ${w.tier_name}`}),await i(d)):n({title:"Error",description:w.message||"Failed to claim achievement",variant:"destructive"}),w}catch(j){console.error("Error with admin claim:",j);const h={success:!1,message:"An error occurred during admin claim"};return n({title:"Error",description:h.message,variant:"destructive"}),h}finally{t(!1)}},[n,i]);return{isLoading:s,claimableAchievements:a,fetchClaimableAchievements:i,claimAchievement:x,adminClaimAchievement:g}},Os=({achievements:s,playerStats:t,playerUuid:a,playerUsername:r,onProfileUpdate:n})=>{var u;const{profile:i}=tt(),{claimableAchievements:x,fetchClaimableAchievements:g}=Ps(),[m,d]=y.useState(s),o=((u=i==null?void 0:i.minecraft_username)==null?void 0:u.toLowerCase())===r.toLowerCase(),j=(i==null?void 0:i.role)==="admin",h=o||j;console.log("PlayerAchievements permission debug:",{playerUsername:r,minecraftUsername:i==null?void 0:i.minecraft_username,userRole:i==null?void 0:i.role,isOwnProfile:o,isAdmin:j,canClaim:h,profileId:i==null?void 0:i.id});const w=y.useCallback(async()=>{try{const{data:l}=await q.from("unlocked_achievements").select(`
          tier:achievement_tiers (
            *,
            definition:achievement_definitions (*)
          )
        `).eq("player_uuid",a),p=(l||[]).map(v=>!v.tier||!v.tier.definition?null:{...v.tier,achievementId:v.tier.definition.id,achievementName:v.tier.definition.name,stat:v.tier.definition.stat,currentValue:t[v.tier.definition.stat]??0,color:"from-blue-500 to-purple-600"}).filter(v=>v!==null);d(p),n&&n()}catch(l){console.error("Failed to refresh unlocked achievements:",l)}},[a,t,n]);y.useEffect(()=>{d(s)},[s]),y.useEffect(()=>{h&&g(a)},[a,h,g]);const c=x.filter(l=>l.is_claimable).length,f=m.reduce((l,p)=>l+p.points,0),_=m.sort((l,p)=>p.tier-l.tier).slice(0,3);return e.jsxs(N,{children:[e.jsx(P,{children:e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"Achievements",e.jsx(M,{variant:"secondary",children:m.length}),h&&c>0&&e.jsxs(M,{className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white animate-pulse",children:[e.jsx(oe,{className:"w-3 h-3 mr-1"}),c," new!"]})]})}),e.jsxs(C,{className:"space-y-4",children:[h&&c>0&&e.jsx("div",{className:"p-3 bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-yellow-800",children:[e.jsx(oe,{className:"w-4 h-4 animate-spin"}),e.jsxs("span",{className:"text-sm font-medium",children:["You have ",c," achievement",c===1?"":"s"," ready to claim!"]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total XP from achievements: ",e.jsx("span",{className:"font-medium text-foreground",children:f})]}),e.jsx(qe,{playerUuid:a,playerUsername:r,playerStats:t,unlockedAchievements:m,onAchievementClaimed:w})]}),m.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(L,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"No achievements unlocked yet."}),e.jsx("p",{className:"text-sm",children:"Complete various activities to earn achievements!"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Recent Achievements"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:_.map(l=>{const p=l.icon;return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg hover:bg-muted transition-colors",children:[e.jsx("div",{className:`w-10 h-10 rounded-full bg-gradient-to-br ${l.color} flex items-center justify-center`,children:e.jsx(p,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:l.achievementName}),e.jsxs(M,{variant:"secondary",className:"text-xs shrink-0",children:[l.points," XP"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:l.name})]})]},`${l.achievementId}-${l.tier}`)})}),m.length>3&&e.jsx("div",{className:"text-center",children:e.jsx(qe,{playerUuid:a,playerUsername:r,playerStats:t,unlockedAchievements:m,onAchievementClaimed:w})})]})]})]})},ie={general:{key:"general",name:"General",color:"text-blue-600",bgColor:"bg-blue-100",description:"Basic gameplay statistics"},building:{key:"building",name:"Building",color:"text-green-600",bgColor:"bg-green-100",description:"Block placement and construction"},mining:{key:"mining",name:"Mining",color:"text-orange-600",bgColor:"bg-orange-100",description:"Block breaking and mining"},combat:{key:"combat",name:"Combat",color:"text-red-600",bgColor:"bg-red-100",description:"Fighting and damage dealing"},movement:{key:"movement",name:"Movement",color:"text-purple-600",bgColor:"bg-purple-100",description:"Walking, swimming, and transportation"},items:{key:"items",name:"Items",color:"text-indigo-600",bgColor:"bg-indigo-100",description:"Item usage and interaction"},crafting:{key:"crafting",name:"Crafting",color:"text-yellow-600",bgColor:"bg-yellow-100",description:"Item creation and crafting"},survival:{key:"survival",name:"Survival",color:"text-pink-600",bgColor:"bg-pink-100",description:"Deaths and survival mechanics"},food:{key:"food",name:"Food",color:"text-emerald-600",bgColor:"bg-emerald-100",description:"Eating and consumption"},exploration:{key:"exploration",name:"Exploration",color:"text-cyan-600",bgColor:"bg-cyan-100",description:"World exploration and discovery"}},Ie={play_time:"Playtime",playtimeHours:"Playtime (Hours)",play_one_minute:"Active Playtime",time_since_death:"Time Since Last Death",time_since_sleep:"Time Since Last Sleep",walk:"Distance Walked",walk_one_cm:"Distance Walked",sprint:"Distance Sprinted",sprint_one_cm:"Distance Sprinted",swim:"Distance Swum",aviate:"Distance Flown",climb:"Distance Climbed",fall:"Distance Fallen",dive:"Distance Dived",jump:"Times Jumped",crouch:"Times Crouched",mobKills:"Mob Kills",damage_dealt:"Damage Dealt",damageDealt:"Total Damage Dealt",damage_taken:"Damage Taken",damage_shield:"Shield Damage Blocked",death:"Total Deaths",deaths:"Deaths",blocksPlaced:"Total Blocks Placed",blocksBroken:"Total Blocks Broken",drop:"Times Dropped Items",open_container:"Containers Opened",itemsCrafted:"Items Crafted",itemsDropped:"Items Dropped",itemsPickedUp:"Items Picked Up",medalPoints:"Medal Points",goldMedals:"Gold Medals",silverMedals:"Silver Medals",bronzeMedals:"Bronze Medals",balance:"Current Balance"},Ts={play_time:"general",playtimeHours:"general",play_one_minute:"general",balance:"general",medalPoints:"general",goldMedals:"general",silverMedals:"general",bronzeMedals:"general",walk:"movement",walk_one_cm:"movement",sprint:"movement",sprint_one_cm:"movement",swim:"movement",aviate:"movement",climb:"movement",fall:"movement",dive:"movement",jump:"movement",crouch:"movement",mobKills:"combat",damage_dealt:"combat",damageDealt:"combat",damage_taken:"combat",damage_shield:"combat",death:"survival",deaths:"survival",time_since_death:"survival",time_since_sleep:"survival",blocksPlaced:"building",blocksBroken:"mining",drop:"items",open_container:"items",itemsDropped:"items",itemsPickedUp:"items",itemsCrafted:"crafting"},As=s=>s.endsWith("_mined")?"mining":s.endsWith("_used")?"building":s.endsWith("_crafted")?"crafting":s.endsWith("_killed")?"combat":s.startsWith("killed_by_")?"survival":s.endsWith("_picked_up")||s.endsWith("_dropped")||s.endsWith("_broken")?"items":s.includes("eat_")||s.includes("drink_")?"food":s.includes("ride_")||s.includes("boat")||s.includes("horse")?"exploration":"general",Ds=s=>{if(Ie[s])return Ie[s];if(s.endsWith("_mined")){const t=s.replace("_mined","");return`${Y(t)} Mined`}if(s.endsWith("_used")){const t=s.replace("_used","");return`${Y(t)} Used`}if(s.endsWith("_crafted")){const t=s.replace("_crafted","");return`${Y(t)} Crafted`}if(s.endsWith("_killed")){const t=s.replace("_killed","");return`${Y(t)} Killed`}if(s.startsWith("killed_by_")){const t=s.replace("killed_by_","");return`Deaths by ${Y(t)}`}if(s.endsWith("_picked_up")){const t=s.replace("_picked_up","");return`${Y(t)} Picked Up`}if(s.endsWith("_dropped")){const t=s.replace("_dropped","");return`${Y(t)} Dropped`}if(s.endsWith("_broken")){const t=s.replace("_broken","");return`${Y(t)} Broken`}return s.replace(/([A-Z])/g," $1").replace(/^./,t=>t.toUpperCase()).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},Y=s=>s.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()),He=s=>Ds(s),Ge=s=>{const t=Ts[s]||As(s);return ie[t]},Ue=(s,t="w-4 h-4")=>({general:e.jsx(_e,{className:t}),building:e.jsx(W,{className:t}),mining:e.jsx(R,{className:t}),combat:e.jsx(K,{className:t}),movement:e.jsx(rt,{className:t}),items:e.jsx(X,{className:t}),crafting:e.jsx(E,{className:t}),survival:e.jsx(H,{className:t}),food:e.jsx(at,{className:t}),exploration:e.jsx(st,{className:t})})[s]||e.jsx(_e,{className:t}),Es=(s,t="w-4 h-4")=>({custom_minecraft_play_time:e.jsx(A,{className:t}),playtimeHours:e.jsx(A,{className:t}),play_one_minute:e.jsx(A,{className:t}),play:e.jsx(A,{className:t}),time_since_death:e.jsx(A,{className:t}),time_since_sleep:e.jsx(A,{className:t}),walk:e.jsx(rt,{className:t}),sprint:e.jsx(T,{className:t}),swim:e.jsx(we,{className:t}),aviate:e.jsx(T,{className:t}),climb:e.jsx(R,{className:t}),fall:e.jsx(ae,{className:t}),dive:e.jsx(we,{className:t}),jump:e.jsx(T,{className:t}),crouch:e.jsx(ae,{className:t}),kill_any:e.jsx(ye,{className:t}),mobKills:e.jsx(ye,{className:t}),damage_dealt:e.jsx(K,{className:t}),damageDealt:e.jsx(K,{className:t}),damage_taken:e.jsx(ne,{className:t}),damage_shield:e.jsx(ne,{className:t}),death:e.jsx(H,{className:t}),deaths:e.jsx(H,{className:t}),killed_by_creeper:e.jsx(H,{className:t}),killed_by_warden:e.jsx(H,{className:t}),use_dirt:e.jsx(Te,{className:t}),blocksPlaced:e.jsx(W,{className:t}),place_torch:e.jsx(T,{className:t}),place_stairs:e.jsx(W,{className:t}),place_wall:e.jsx(W,{className:t}),place_cactus:e.jsx(ve,{className:t}),place_glass:e.jsx(W,{className:t}),place_rails:e.jsx(V,{className:t}),place_sign:e.jsx(W,{className:t}),place_banner:e.jsx(W,{className:t}),place_scaffolding:e.jsx(W,{className:t}),place_lantern:e.jsx(T,{className:t}),place_candle:e.jsx(T,{className:t}),place_sapling:e.jsx(ve,{className:t}),mine_ground:e.jsx(Te,{className:t}),mine_stone:e.jsx(R,{className:t}),mine_wood:e.jsx(ve,{className:t}),mine_coal_ore:e.jsx(R,{className:t}),mine_iron_ore:e.jsx(R,{className:t}),mine_gold_ore:e.jsx(pe,{className:t}),mine_diamond_ore:e.jsx(We,{className:t}),mine_emerald_ore:e.jsx(se,{className:t}),mine_redstone_ore:e.jsx(T,{className:t}),mine_lapis_ore:e.jsx(se,{className:t}),mine_copper_ore:e.jsx(R,{className:t}),mine_ancient_debris:e.jsx(We,{className:t}),mine_nether_quartz_ore:e.jsx(se,{className:t}),blocksBroken:e.jsx(be,{className:t}),drop:e.jsx(ae,{className:t}),open_container:e.jsx(X,{className:t}),itemsDropped:e.jsx(ae,{className:t}),itemsPickedUp:e.jsx(Qt,{className:t}),use_bow:e.jsx(be,{className:t}),use_crossbow:e.jsx(be,{className:t}),use_shears:e.jsx(E,{className:t}),use_flint:e.jsx(T,{className:t}),use_hoe:e.jsx(Ve,{className:t}),break_tools:e.jsx(E,{className:t}),use_fireworks:e.jsx(T,{className:t}),use_potion:e.jsx(X,{className:t}),use_egg:e.jsx(X,{className:t}),use_water_bucket:e.jsx(X,{className:t}),use_lava_bucket:e.jsx(X,{className:t}),itemsCrafted:e.jsx(E,{className:t}),craft_bread:e.jsx(E,{className:t}),craft_tools:e.jsx(E,{className:t}),craft_armor:e.jsx(ne,{className:t}),craft_sword:e.jsx(K,{className:t}),craft_compass:e.jsx(st,{className:t}),craft_clock:e.jsx(A,{className:t}),craft_paper:e.jsx(E,{className:t}),craft_bookshelf:e.jsx(E,{className:t}),enchant:e.jsx(se,{className:t}),eat_meat:e.jsx(De,{className:t}),eat_fish:e.jsx(Gt,{className:t}),eat_veggie:e.jsx(zt,{className:t}),eat_cookie:e.jsx(Ee,{className:t}),eat_soup:e.jsx(at,{className:t}),eat_rawmeat:e.jsx(De,{className:t}),eat_junkfood:e.jsx(Ee,{className:t}),drink_milk:e.jsx(Vt,{className:t}),ride_horse:e.jsx(V,{className:t}),ride_pig:e.jsx(V,{className:t}),ride_boat:e.jsx(we,{className:t}),ride_minecart:e.jsx(V,{className:t}),ride_strider:e.jsx(V,{className:t}),biomes:e.jsx(J,{className:t}),sleep:e.jsx(Xt,{className:t}),breed:e.jsx(H,{className:t}),trade:e.jsx(pe,{className:t}),medalPoints:e.jsx(L,{className:t}),goldMedals:e.jsx($,{className:`${t} text-yellow-500`}),silverMedals:e.jsx(Ke,{className:`${t} text-gray-400`}),bronzeMedals:e.jsx(ke,{className:`${t} text-yellow-600`}),balance:e.jsx(pe,{className:t})})[s]||e.jsx(_e,{className:t}),Ws=({statsWithMeta:s,loading:t,onClose:a})=>{const[r,n]=y.useState(""),[i,x]=y.useState("all"),[g,m]=y.useState("all"),[d,o]=y.useState(new Set(["general","building","mining","combat"])),j=y.useMemo(()=>{const u={};return Object.keys(ie).forEach(l=>{u[l]=[]}),s.forEach(l=>{ie[l.category]?u[l.category].push(l):(u.uncategorized||(u.uncategorized=[]),u.uncategorized.push(l))}),Object.values(u).forEach(l=>l.sort((p,v)=>v.value-p.value)),u},[s]),h=[...Object.values(ie),{key:"uncategorized",name:"Other",color:"text-gray-600",bgColor:"bg-gray-100",description:"Uncategorized stats"}],w=y.useMemo(()=>{const u={};return Object.entries(j).forEach(([l,p])=>{if(i!=="all"&&i!==l)return;const v=p.filter(k=>r===""||k.name.toLowerCase().includes(r.toLowerCase())||k.key.toLowerCase().includes(r.toLowerCase())?g==="high-values"?k.value>=100:!0:!1);v.length>0&&(u[l]=v)}),u},[j,r,i,g]),c=Object.values(w).reduce((u,l)=>u+l.length,0);if(t)return e.jsx(le,{open:!0,onOpenChange:a,children:e.jsxs(de,{className:"max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(me,{className:"flex-shrink-0",children:e.jsxs(ue,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"All Statistics"]})}),e.jsx("div",{className:"text-center py-8",children:"Loading all player statistics..."})]})});const f=(u,l)=>{if(l.includes("time")&&(l.includes("play")||l.includes("custom"))){const p=Math.floor(u/24),v=Math.floor(u%24);return p>0?`${p}d ${v}h`:`${v}h`}return l.includes("distance")||l.includes("walk")||l.includes("sprint")||l.includes("swim")?u>=1e3?`${(u/1e3).toFixed(1)}km`:`${u}m`:u.toLocaleString()},_=u=>{const l=new Set(d);l.has(u)?l.delete(u):l.add(u),o(l)};return e.jsx(le,{open:!0,onOpenChange:a,children:e.jsxs(de,{className:"max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(me,{className:"flex-shrink-0",children:e.jsxs(ue,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"All Statistics"]})}),e.jsx("div",{className:"flex-shrink-0 space-y-4 border-b pb-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(St,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(Pt,{placeholder:"Search statistics...",value:r,onChange:u=>n(u.target.value),className:"flex-1"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Me,{value:i,onValueChange:x,children:[e.jsx(Se,{className:"w-[160px]",children:e.jsx(Pe,{placeholder:"Category"})}),e.jsxs(Oe,{children:[e.jsx(te,{value:"all",children:"All Categories"}),h.map(u=>e.jsx(te,{value:u.key,children:e.jsxs("div",{className:"flex items-center gap-2",children:[Ue(u.key,"w-3 h-3"),u.name]})},u.key))]})]}),e.jsxs(Me,{value:g,onValueChange:u=>m(u),children:[e.jsxs(Se,{className:"w-[140px]",children:[e.jsx(Ut,{className:"w-4 h-4 mr-2"}),e.jsx(Pe,{})]}),e.jsxs(Oe,{children:[e.jsx(te,{value:"all",children:"All Stats"}),e.jsx(te,{value:"high-values",children:"High Values"})]})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:Object.keys(w).length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:r||i!=="all"||g!=="all"?"No statistics found matching your filters.":"No statistics available."}):e.jsx("div",{className:"space-y-4",children:Object.entries(w).map(([u,l])=>{const p=h.find(k=>k.key===u)||{name:"Other",color:"text-gray-600",bgColor:"bg-gray-100",description:"Uncategorized stats",key:"uncategorized"},v=d.has(u);return e.jsxs(Ot,{open:v,onOpenChange:()=>_(u),children:[e.jsx(Tt,{asChild:!0,children:e.jsx(N,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:e.jsx(P,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${p.bgColor}`,children:Ue(p.key,`w-5 h-5 ${p.color}`)}),e.jsxs("div",{children:[e.jsx(O,{className:"text-lg",children:p.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:p.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(M,{variant:"secondary",children:[l.length," stats"]}),v?e.jsx(At,{className:"w-4 h-4"}):e.jsx(Dt,{className:"w-4 h-4"})]})]})})})}),e.jsx(Et,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-2",children:l.map(k=>e.jsx(N,{className:"hover:shadow-md transition-shadow",children:e.jsxs(C,{className:"p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[Es(k.key,`w-4 h-4 ${p.color}`),e.jsx("span",{className:"font-medium text-sm truncate",title:k.name,children:k.name})]})}),e.jsx("div",{className:"text-xl font-bold text-primary",children:f(k.value,k.key)})]})},k.key))})})]},u)})})}),e.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",c," statistics"]}),e.jsx(F,{onClick:a,children:"Close"})]})]})})},Ls=async s=>{try{const t=await Wt(s),a=Object.entries(t).map(([r,n])=>({key:r,value:n,name:He(r),category:Ge(r).name}));return{flatStats:t,statsWithMeta:a}}catch(t){console.error("Error fetching comprehensive player stats:",t);const{data:a,error:r}=await q.from("player_stats").select("stats").eq("player_uuid",s).single();if(r)return console.error("Error fetching player stats from database:",r),{flatStats:{},statsWithMeta:[]};const n=(a==null?void 0:a.stats)||{},i=Lt(n),x=Object.entries(i).map(([g,m])=>({key:g,value:m,name:He(g),category:Ge(g).name}));return{flatStats:i,statsWithMeta:x}}},Fs=s=>{const{data:t,isLoading:a,error:r}=Ft({queryKey:["playerAllStats",s],queryFn:()=>Ls(s),enabled:!!s,staleTime:3e5});return{flatStats:(t==null?void 0:t.flatStats)??{},statsWithMeta:(t==null?void 0:t.statsWithMeta)??[],loading:a,error:r}},Bs=({profile:s,onClose:t,onProfileUpdate:a})=>{const{userRole:r}=tt(),[n,i]=y.useState(!1),[x,g]=y.useState(!1),{data:m}=Xe(s.id),{data:d}=Bt(s.id),{flatStats:o,statsWithMeta:j,loading:h}=Fs(s.id),w=r==="admin"||r==="moderator",c=(m==null?void 0:m.find(k=>k.is_verified))||(m==null?void 0:m[0]),f=d,_=(c==null?void 0:c.badge_type)||(f==null?void 0:f.badge_type)||"Player",u=(c==null?void 0:c.badge_color)||(f==null?void 0:f.badge_color)||"#6b7280",l=(c==null?void 0:c.is_verified)||(f==null?void 0:f.is_verified)||!1,p={blocksPlaced:o.blocksPlaced??o.blocksPlaced??0,blocksBroken:o.blocksBroken??o.blocksBroken??0,mobKills:o.mobKills??o.mobKills??0,balance:o.balance??o.balance??0,itemsCrafted:o.itemsCrafted??o.itemsCrafted??0,itemsDropped:o.itemsDropped??o.itemsDropped??0,itemsPickedUp:o.itemsPickedUp??o.itemsPickedUp??0,medalPoints:o.medalPoints??o.medalPoints??0,goldMedals:o.goldMedals??o.goldMedals??0,silverMedals:o.silverMedals??o.silverMedals??0,bronzeMedals:o.bronzeMedals??o.bronzeMedals??0},v=()=>{console.log("Contact clicked for:",s.username)};return e.jsx(le,{open:!0,onOpenChange:k=>!k&&t(),children:e.jsxs(de,{className:"max-w-4xl max-h-[95vh] overflow-hidden flex flex-col p-0",children:[e.jsx("div",{className:"flex-shrink-0 p-6 pb-0",children:e.jsx(me,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{children:"Player Profile"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{style:{backgroundColor:u,color:"white"},className:"text-xs",children:_}),l&&e.jsx(M,{variant:"outline",className:"text-xs text-green-600 border-green-600",children:"Verified"})]})]}),w&&e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>g(!0),children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"Manage Badges"]})]})})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(Je,{defaultValue:"overview",className:"w-full h-full flex flex-col",children:[e.jsx("div",{className:"flex-shrink-0 px-6",children:e.jsxs(et,{className:"grid w-full grid-cols-4",children:[e.jsx(z,{value:"overview",children:"Overview"}),e.jsx(z,{value:"stats",children:"Statistics"}),e.jsx(z,{value:"achievements",children:"Achievements"}),e.jsx(z,{value:"info",children:"Player Info"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-6 pb-6",children:[e.jsxs(Q,{value:"overview",className:"space-y-6 mt-6",children:[e.jsx(_s,{profile:s}),e.jsx(Ns,{profile:s}),e.jsx(ks,{bio:s.bio}),e.jsx(Cs,{profile:s,isAuthenticated:!0,onContactClick:v})]}),e.jsx(Q,{value:"stats",className:"mt-6",children:e.jsx(Ss,{stats:{...p,...o},onViewAllStats:()=>i(!0),loading:h})}),e.jsx(Q,{value:"achievements",className:"mt-6",children:e.jsx(Os,{achievements:s.achievements||[],playerStats:s.stats,playerUuid:s.id,playerUsername:s.username,onProfileUpdate:a})}),e.jsx(Q,{value:"info",className:"mt-6",children:e.jsx(Ms,{profile:s})})]})]})}),n&&e.jsx(Ws,{statsWithMeta:j,loading:h,onClose:()=>i(!1)}),x&&e.jsx(Yt,{playerUuid:s.id,playerName:s.username,isOpen:x,onClose:()=>g(!1)})]})})},Js=()=>{const{username:s}=$t(),t=Ze(),[a,r]=y.useState(null),{profile:n,loading:i,error:x}=qt(s||"");fe(s||""),y.useEffect(()=>{n&&r(n)},[n]);const g=()=>{t("/community")},m=()=>{window.location.reload()};return i?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):x||!a?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs(F,{variant:"outline",onClick:()=>t("/community"),className:"mb-6",children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Back to Community"]}),e.jsx(N,{children:e.jsxs(C,{className:"p-8 text-center",children:[e.jsx(ce,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Player Not Found"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:['The player "',s,`" could not be found or doesn't exist.`]}),e.jsx(F,{onClick:()=>t("/community"),children:"Return to Community"})]})})]})})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs(F,{variant:"outline",onClick:g,className:"mb-6",children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Back to Community"]}),e.jsx(Bs,{profile:a,onClose:g,onProfileUpdate:m})]})})})};export{Js as default};
